<!DOCTYPE html>
<!-- Page generated 2022-04-25 09:39:05 +0900-->
<html lang="ja"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Build your Java image | Docker ドキュメント</title>
  <meta name="description" content="Learn how to build your first Docker image by writing a Dockerfile" />
  <meta name="keywords" content="Java, build, images, dockerfile">
  <link rel="canonical" href="https://localhost:4000{{ site.baseurl }}/language/java/build-images/" />

  <!-- favicon -->
  <link rel="icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <link rel="apple-touch-icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta name="msapplication-TileImage" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico">
  <meta property="og:image" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
  <meta name="theme-color" content="#2496ed" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- hide elements that are only shown without JavaScript enabled -->
  <script>document.documentElement.classList.add('js')</script>
  <style>html.js .no-js { display: none !important; }</style><script defer src="/docs.docker.jp.onthefly/js/theme-switcher.js"></script>
  <script defer src="/docs.docker.jp.onthefly/js/anchorlinks.js"></script>
  <script defer src="/docs.docker.jp.onthefly/js/jquery.js"></script>
  <script defer src="/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
  <script defer src="/docs.docker.jp.onthefly/js/docs.js"></script><script defer src="/docs.docker.jp.onthefly/js/search.js"></script><link rel="preload" as="font" href="https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-UFVZ0bf8pkAg.woff2" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/docs.docker.jp.onthefly/fonts/geomanist/hinted-Geomanist-Book.woff2"    type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/docs.docker.jp.onthefly/fonts/geomanist/hinted-Geomanist-Regular.woff2" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/docs.docker.jp.onthefly/fonts/glyphicons-halflings-regular.woff2"       type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/docs.docker.jp.onthefly/fonts/fontawesome-webfont.woff2?v=4.7.0"        type="font/woff2" crossorigin="anonymous">

  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/font-awesome.min.css">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/bootstrap.min.css">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/style.css" id="pagestyle">

  <!-- SEO stuff -->
  <meta name="twitter:title" itemprop="title name" content="Build your Java image"/>
  <meta name="twitter:description" property="og:description" itemprop="description" content="" />
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:domain" content="matsuand.github.io"/>
  <meta name="twitter:site" content="@docker_docs"/>
  <meta name="twitter:url" content="https://twitter.com/docker_docs"/>
  <meta name="twitter:image:src" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:image:alt" content="Docker ドキュメント"/>
  <meta property="og:title" content="Build your Java image" />
  <meta property="og:description" content="Learn how to build your first Docker image by writing a Dockerfile" />
  <meta property="og:type" content="website"/>
  <meta property="og:updated_time" itemprop="dateUpdated" content="2022-04-25T09:39:05+09:00"/>
  <meta property="og:image" itemprop="image primaryImageOfPage" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta property="og:locale" content="ja_JP" />
  <meta property="og:url" content="https://matsuand.github.io/docs.docker.jp.onthefly/language/java/build-images/" />
  <meta property="og:site_name" content="Docker ドキュメント" />
  <meta property="article:published_time" itemprop="datePublished" content="2022-04-25T09:39:05+09:00"/>
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"WebPage","headline":"Build your Java image","description":"Learn how to build your first Docker image by writing a Dockerfile","url":"https://docs.docker.com/language/java/build-images/"}</script>
  <!-- END SEO STUFF -->
</head>
<body class="colums">
    <header>
        <nav class="nav-secondary navbar navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/docs.docker.jp.onthefly/">
                <img class="logo" src="/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs" width="160" height="28" />
            </a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="logo-mobile">
    <a href="/docs.docker.jp.onthefly/">
        <img src="/docs.docker.jp.onthefly/images/docker-icon.svg" alt="Docker Docs" title="Docker Docs" width="30" height="30" />
    </a>
</div>
<div class="search-form" id="search-div">
    <form class="search-form form-inline" id="searchForm" action="/docs.docker.jp.onthefly/search/" method="get">
        <label for="st-search-input" class="sr-only">検索</label>
        <input class="search-field form-control ds-input" id="st-search-input" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteResults"></div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container hidden-sm hidden-xs">
    <div>
        <ul class="nav navbar-nav"><li><a href="/docs.docker.jp.onthefly/" id="home">ホーム</a></li><li><a href="/docs.docker.jp.onthefly/get-started/overview/" id="guides">ガイド</a></li><li><a href="/docs.docker.jp.onthefly/desktop/" id="manuals">マニュアル</a></li><li><a href="/docs.docker.jp.onthefly/reference/" id="reference">リファレンス</a></li><li><a href="/docs.docker.jp.onthefly/samples/" id="samples">サンプル</a></li></ul>
    </div>
    <div class="ctrl-right">
        <a href="javascript:void(0)" id="menu-toggle" aria-label="現在ページのメニュートグル"><i class="fa fa-indent" aria-hidden="true"></i></a>
    </div>
</div>
<div class="row hidden-sm hidden-xs">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li><a href="/docs.docker.jp.onthefly/" title="Docker docs homepage"><i class="fa fa-home"></i></a></li>
            <li><a href="/docs.docker.jp.onthefly/get-started/overview/">ガイド</a></li><li><a href="/docs.docker.jp.onthefly/language/">各種言語別ガイド (New)</a></li><li><a href="/docs.docker.jp.onthefly/language/java/">Java</a></li><li><a href="/docs.docker.jp.onthefly/language/java/build-images/">イメージのビルド</a></li></ol>
    </nav>
</div></div>
    </div>
</nav>

    </header>
    <div class="wrapper right-open">
        <div class="container-fluid">
            <div class="row">
                <div class="col-body">
                    <main class="col-content content">
                        <section class="section"><h1>Build your Java image</h1><p><em class="reading-time">読む時間の目安: 11 分</em></p><ul class="pagination">
  <li class="active"><a href="/docs.docker.jp.onthefly/language/java/build-images/">イメージのビルド</a></li>
  <li><a href="/docs.docker.jp.onthefly/language/java/run-containers/">コンテナーとしてイメージ実行</a></li>
  <li><a href="/docs.docker.jp.onthefly/language/java/develop/">コンテナーの開発利用</a></li>
  <li><a href="/docs.docker.jp.onthefly/language/java/run-tests/">テストの実行</a></li>
  <li><a href="/docs.docker.jp.onthefly/language/java/configure-ci-cd/">CI/CD の設定</a></li>
  <li><a href="/docs.docker.jp.onthefly/language/java/deploy/">アプリのデプロイ</a></li>
</ul>

<h2 id="prerequisites">Prerequisites</h2>

<p>Work through the orientation and setup in Get started <a href="/docs.docker.jp.onthefly/get-started/" target="_blank" rel="noopener" class="_">Part 1</a> to understand Docker concepts. Refer to the following section for Java prerequisites.</p>

<!-- This text will be included in Build images topic in the Get started guides -->

<h3 id="enable-buildkit">BuildKit の有効化</h3>

<p>イメージビルドを行うにあたっては、マシン上において BuildKit が有効になっていることを確認してください。
BuildKit が有効になっていれば、Docker イメージビルドを効率的に行うことができます。
詳しくは <a href="../develop/develop-images/build_enhancements.md">BuildKit によるイメージ構築</a> を参照してください。</p>

<p>BuildKit は Docker Desktop 上の全ユーザーに対して、デフォルトで有効になっています。
Docker Desktop をインストールしているのであれば、手動で BuildKit を有効にする必要はありません。
Linux 上において Docker を利用している場合は、環境変数を用いるか、あるいは BuildKit がデフォルト設定となるようにして、BuildKit を有効にします。</p>

<p><code class="highlighter-rouge">docker build</code>コマンド時に環境変数 BuildKit を設定するには、以下のようにします。</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> <span class="nv">DOCKER_BUILDKIT</span><span class="o">=</span>1 docker build <span class="nb">.</span>
</code></pre></div></div>

<p>デフォルトで BuildKit を有効にするには、<code class="highlighter-rouge">/etc/docker/daemon.json</code>内のデーモン設定を<code class="highlighter-rouge">true</code>に設定して、デーモンを再起動します。
<code class="highlighter-rouge">daemon.json</code>ファイルが存在していない場合は、この<code class="highlighter-rouge">daemon.json</code>ファイルを新規生成して、以下の記述を追加します。</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"features"</span><span class="p">:{</span><span class="s2">"buildkit"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>そして Docker デーモンを再起動します。</p>

<h2 id="overview">Overview</h2>

<p>Now that we have a good overview of containers and the Docker platform, let’s take a look at building our first image. An image includes everything needed to run an application - the code or binary, runtime, dependencies, and any other file system objects required.</p>

<p>To complete this tutorial, you need the following:</p>

<ul>
  <li>Docker running locally. Follow the instructions to <a href="/docs.docker.jp.onthefly/get-docker/">download and install Docker</a></li>
  <li>A Git client</li>
  <li>An IDE or a text editor to edit files. We recommend using <a href="https://www.jetbrains.com/idea/download/" target="_blank" rel="noopener" class="_">IntelliJ Community Edition</a>.</li>
</ul>

<h2 id="sample-application">Sample application</h2>

<p>Let’s clone the sample application that we’ll be using in this module to our local development machine. Run the following commands in a terminal to clone the repo.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> <span class="nb">cd</span> /path/to/working/directory
<span class="gp">$</span> git clone https://github.com/spring-projects/spring-petclinic.git
<span class="gp">$</span> <span class="nb">cd </span>spring-petclinic
</code></pre></div></div>

<h2 id="test-the-application-without-docker-optional">Test the application without Docker (optional)</h2>

<p>In this step, we will test the application locally without Docker, before we
continue with building and running the application with Docker. This section
requires you to have Java OpenJDK version 15 or later installed on your machine.
<a href="https://jdk.java.net/" target="_blank" rel="noopener" class="_">Download and install Java</a></p>

<p>If you prefer to not install Java on your machine, you can skip this step, and
continue straight to the next section, in which we explain how to build and run
the application in Docker, which does not require you to have Java installed on
your machine.</p>

<p>Let’s start our application and make sure it is running properly. Maven will manage all the project processes (compiling, tests, packaging, etc). The <strong>Spring Pets Clinic</strong> project we cloned earlier contains an embedded version of Maven. Therefore, we don’t need to install Maven separately on your local machine.</p>

<p>Open your terminal and navigate to the working directory we created and run the following command:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> ./mvnw spring-boot:run
</code></pre></div></div>

<p>This downloads the dependencies, builds the project, and starts it.</p>

<p>To test that the application is working properly, open a new browser and navigate to <code class="highlighter-rouge">http://localhost:8080</code>.</p>

<p>Switch back to the terminal where our server is running and you should see the following requests in the server logs. The data will be different on your machine.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">o.s.s.petclinic.PetClinicApplication     : Started
PetClinicApplication in 11.743 seconds (JVM running for 12.364)
</span></code></pre></div></div>

<p>Great! We verified that the application works. At this stage, you’ve completed
testing the server script locally.</p>

<p>Press <code class="highlighter-rouge">CTRL-c</code> from within the terminal session where the server is running to stop it.</p>

<p>We will now continue to build and run the application in Docker.</p>

<h2 id="create-a-dockerfile-for-java">Create a Dockerfile for Java</h2>

<p>Dockerfile とは、 Docker イメージを取得する命令を含んだテキストファイルのことです。
Docker に対して<code class="highlighter-rouge">docker build</code>コマンドを実行してイメージビルドを指示すると、Docker は記述された命令を読み込んで実行し、最終的に Docker イメージを作り出します。</p>

<p>ではアプリケーション向けに Dockerfile を生成していく手順を見ていきます。
プロジェクトのルートディレクトリに<code class="highlighter-rouge">Dockerfile</code>という名前のファイルを生成して、テキストエディターでこれを開きます。</p>

<blockquote>
  <p><strong>Dockerfile の名前を何にするか</strong></p>

  <p>Dockerfile に対して用いられるデフォルトのファイル名は、 <code class="highlighter-rouge">Dockerfile</code> です (ファイル拡張子はありません)。
このデフォルトファイル名を用いておけば、<code class="highlighter-rouge">docker build</code>コマンドを実行する際に、コマンドラインフラグを追加して指定する必要がありません。</p>

  <p>プロジェクトによっては、特定の目的のため、Dockerfile に別名を与える場合があります。
普通行われる慣例としては、<code class="highlighter-rouge">Dockerfile.&lt;something&gt;</code>や<code class="highlighter-rouge">&lt;something&gt;.Dockerfile</code>とします。
このような Dockerfile は、<code class="highlighter-rouge">docker build</code>コマンドの実行にあたって、<code class="highlighter-rouge">--file</code>オプション (その短縮形<code class="highlighter-rouge">-f</code>) を用いて指定します。
<code class="highlighter-rouge">--file</code>オプションの利用方法については、<code class="highlighter-rouge">docker build</code>リファレンス内の <a href="/docs.docker.jp.onthefly/engine/reference/commandline/build/#specify-a-dockerfile--f">Dockerfile の指定</a> のセクションを参照してください。</p>

  <p>プロジェクトの主となる Dockerfile には、デフォルト名 (<code class="highlighter-rouge">Dockerfile</code>) を用いることをお勧めします。
本ガイドに示すほとんどの例においては、この名前を用いています。</p>
</blockquote>

<p>Docker ファイルの 1 行めに書くのは <a href="/docs.docker.jp.onthefly/engine/reference/builder/#syntax"><code class="highlighter-rouge"># syntax</code>パーサーディレクティブ</a> です。
これは <strong>任意の記述</strong> ではありますが、Dockerfile の解析にあたって Docker ビルダーがどの文法を採用するのかを指示します。
また古い Docker バージョンにおいて BuildKit を利用する際に、ビルド前にパーサーをアップグレードするようになります。
<a href="/docs.docker.jp.onthefly/engine/reference/builder/#parser-directives">パーサーディレクティブ</a> は Dockerfile において、いずれのコメント、空行、Dockerfile 命令よりも前に、つまり第一に記述することが必要です。</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># syntax=docker/dockerfile:1</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">docker/dockerfile:1</code>を用いることをお勧めします。
こうしておくと、常に文法バージョン 1 の最新リリース版を指し示すことになります。
BuildKit は、ビルド処理の前に文法に更新がないかを自動的にチェックし、最新バージョンが用いられていることを確認します。</p>

<p>Next, we need to add a line in our Dockerfile that tells Docker what base image
we would like to use for our application.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># syntax=docker/dockerfile:1</span>

<span class="k">FROM</span><span class="s"> openjdk:16-alpine3.13</span>
</code></pre></div></div>

<p>Docker images can be inherited from other images. For this guide, we use the
official <code class="highlighter-rouge">openjdk</code> image from Docker Hub with Java JDK that already has all the
tools and packages that we need to run a Java application.</p>

<p>To make things easier when running the rest of our commands, let’s set the image’s
working directory. This instructs Docker to use this path as the default location
for all subsequent commands. By doing this, we do not have to type out full file
paths but can use relative paths based on the working directory.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">WORKDIR</span><span class="s"> /app</span>
</code></pre></div></div>

<p>Usually, the very first thing you do once you’ve downloaded a project written in
Java which is using Maven for project management is to install dependencies.</p>

<p>Before we can run <code class="highlighter-rouge">mvnw dependency</code>, we need to get the Maven wrapper and our
<code class="highlighter-rouge">pom.xml</code> file into our image. We’ll use the <code class="highlighter-rouge">COPY</code> command to do this. The
<code class="highlighter-rouge">COPY</code> command takes two parameters. The first parameter tells Docker what
file(s) you would like to copy into the image. The second parameter tells Docker
where you want that file(s) to be copied to. We’ll copy all those files and
directories into our working directory - <code class="highlighter-rouge">/app</code>.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">COPY</span><span class="s"> .mvn/ .mvn</span>
<span class="k">COPY</span><span class="s"> mvnw pom.xml ./</span>
</code></pre></div></div>

<p>Once we have our <code class="highlighter-rouge">pom.xml</code> file inside the image, we can use the <code class="highlighter-rouge">RUN</code> command
to execute the command <code class="highlighter-rouge">mvnw dependency:go-offline</code>. This works exactly the same
way as if we were running <code class="highlighter-rouge">mvnw</code> (or <code class="highlighter-rouge">mvn</code>) dependency locally on our machine,
but this time the dependencies will be installed into the image.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">RUN </span>./mvnw dependency:go-offline
</code></pre></div></div>

<p>At this point, we have an Alpine version 3.13 image that is based on OpenJDK version 16, and we have also installed our dependencies. The next thing we need to do is to add our source code into the image. We’ll use the <code class="highlighter-rouge">COPY</code> command just like we did with our <code class="highlighter-rouge">pom.xml</code> file above.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">COPY</span><span class="s"> src ./src</span>
</code></pre></div></div>

<p>This <code class="highlighter-rouge">COPY</code> command takes all the files located in the current directory and copies them into the image. Now, all we have to do is to tell Docker what command we want to run when our image is executed inside a container. We do this using the <code class="highlighter-rouge">CMD</code> command.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CMD</span><span class="s"> ["./mvnw", "spring-boot:run"]</span>
</code></pre></div></div>

<p>Here’s the complete Dockerfile.</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># syntax=docker/dockerfile:1</span>

<span class="k">FROM</span><span class="s"> openjdk:16-alpine3.13</span>

<span class="k">WORKDIR</span><span class="s"> /app</span>

<span class="k">COPY</span><span class="s"> .mvn/ .mvn</span>
<span class="k">COPY</span><span class="s"> mvnw pom.xml ./</span>
<span class="k">RUN </span>./mvnw dependency:go-offline

<span class="k">COPY</span><span class="s"> src ./src</span>

<span class="k">CMD</span><span class="s"> ["./mvnw", "spring-boot:run"]</span>
</code></pre></div></div>

<h3 id="create-a-dockerignore-file">Create a <code class="highlighter-rouge">.dockerignore</code> file</h3>

<p>To increase the performance of the build, and as a general best practice, we recommend that you create a <code class="highlighter-rouge">.dockerignore</code> file in the same directory as the Dockerfile. For this tutorial, your <code class="highlighter-rouge">.dockerignore</code> file should contain just one line:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>target
</code></pre></div></div>

<p>This line excludes the <code class="highlighter-rouge">target</code> directory, which contains output from Maven, from the Docker build context.
There are many good reasons to carefully structure a <code class="highlighter-rouge">.dockerignore</code> file, but this one-line file is good enough for now.</p>

<h2 id="build-an-image">Build an image</h2>

<p>Now that we’ve created our Dockerfile, let’s build our image. To do this, we use the <code class="highlighter-rouge">docker build</code> command. The <code class="highlighter-rouge">docker build</code> command builds Docker images from a Dockerfile and a “context”. A build’s context is the set of files located in the specified PATH or URL. The Docker build process can access any of the files located in this context.</p>

<p>The build command optionally takes a <code class="highlighter-rouge">--tag</code> flag. The tag is used to set the name of the image and an optional tag in the format <code class="highlighter-rouge">name:tag</code>. We’ll leave off the optional <code class="highlighter-rouge">tag</code> for now to help simplify things. If we do not pass a tag, Docker uses “latest” as its default tag. You can see this in the last line of the build output.</p>

<p>Let’s build our first Docker image.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker build <span class="nt">--tag</span> java-docker <span class="nb">.</span>
</code></pre></div></div>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">Sending build context to Docker daemon  5.632kB
Step 1/7 : FROM java:3.7-alpine
Step 2/7 : WORKDIR /app
</span><span class="c">...
</span><span class="go">Successfully built a0bb458aabd0
Successfully tagged java-docker:latest
</span></code></pre></div></div>

<h2 id="view-local-images">View local images</h2>

<p>To see a list of images we have on our local machine, we have two options. One is to use the CLI and the other is to use <a href="/docs.docker.jp.onthefly/desktop/dashboard/#explore-your-images">Docker Desktop</a>. As we are currently working in the terminal let’s take a look at listing images using the CLI.</p>

<p>To list images, simply run the <code class="highlighter-rouge">docker images</code> command.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker images
<span class="go">REPOSITORY          TAG                 IMAGE ID            CREATED          SIZE
java-docker         latest              b1b5f29f74f0        47 minutes ago   567MB
</span></code></pre></div></div>

<p>You should see at least the we just built <code class="highlighter-rouge">java-docker:latest</code>.</p>

<h2 id="tag-images">Tag images</h2>

<p>An image name is made up of slash-separated name components. Name components may contain lowercase letters, digits, and separators. A separator is defined as a period, one or two underscores, or one or more dashes. A name component may not start or end with a separator.</p>

<p>An image is made up of a manifest and a list of layers. Do not worry too much about manifests and layers at this point other than a “tag” points to a combination of these artifacts. You can have multiple tags for an image. Let’s create a second tag for the image we built and take a look at its layers.</p>

<p>To create a new tag for the image we’ve built above, run the following command:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker tag java-docker:latest java-docker:v1.0.0
</code></pre></div></div>

<p>The <code class="highlighter-rouge">docker tag</code> command creates a new tag for an image. It does not create a new image. The tag points to the same image and is just another way to reference the image.</p>

<p>Now, run the <code class="highlighter-rouge">docker images</code> command to see a list of our local images.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker images
<span class="go">REPOSITORY    TAG      IMAGE ID		  CREATED		  SIZE
java-docker   latest   b1b5f29f74f0	  59 minutes ago	567MB
java-docker   v1.0.0   b1b5f29f74f0	  59 minutes ago	567MB
</span></code></pre></div></div>

<p>You can see that we have two images that start with <code class="highlighter-rouge">java-docker</code>. We know they are the same image because if you take a look at the <code class="highlighter-rouge">IMAGE ID</code> column, you can see that the values are the same for the two images.</p>

<p>Let’s remove the tag that we just created. To do this, we’ll use the <code class="highlighter-rouge">rmi</code> command. The <code class="highlighter-rouge">rmi</code> command stands for “remove image”.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker rmi java-docker:v1.0.0
<span class="go">Untagged: java-docker:v1.0.0
</span></code></pre></div></div>

<p>Note that the response from Docker tells us that the image has not been removed but only “untagged”. You can check this by running the <code class="highlighter-rouge">docker images</code> command.</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker images
<span class="go">REPOSITORY      TAG     IMAGE ID        CREATED              SIZE
java-docker    	latest	b1b5f29f74f0	59 minutes ago	     567MB
</span></code></pre></div></div>

<p>Our image that was tagged with <code class="highlighter-rouge">:v1.0.0</code> has been removed, but we still have the <code class="highlighter-rouge">java-docker:latest</code> tag available on our machine.</p>

<h2 id="next-steps">Next steps</h2>

<p>In this module, we took a look at setting up our example Java application that we’ll use for the rest of the tutorial. We also created a Dockerfile that we used to build our Docker image. Then, we took a look at tagging our images and removing images. In the next module, we’ll take a look at how to:</p>

<p><a href="/docs.docker.jp.onthefly/language/java/run-containers/" class="button primary-btn">Run your image as a container</a></p>

<h2 id="feedback">Feedback</h2>

<p>Help us improve this topic by providing your feedback. Let us know what you think by creating an issue in the <a href="https://github.com/docker/docker.github.io/issues/new?title=[Java%20docs%20feedback]" target="_blank" rel="noopener" class="_">Docker Docs</a> GitHub repository. Alternatively, <a href="https://github.com/docker/docker.github.io/pulls" target="_blank" rel="noopener" class="_">create a PR</a> to suggest updates.</p>

<p><br /></p>
<span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="/docs.docker.jp.onthefly/search/?q=Java">Java</a>, <a href="/docs.docker.jp.onthefly/search/?q=build">build</a>, <a href="/docs.docker.jp.onthefly/search/?q=images">images</a>, <a href="/docs.docker.jp.onthefly/search/?q=dockerfile">dockerfile</a></span><div class="ratings-div"><div id="pd_rating_holder_8453675"></div></div></section>
                    </main>
                    <nav class="col-nav">
                        <div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
                            <div id="navbar" class="nav-sidebar">
                                <ul class="nav hidden-md hidden-lg"></ul>
                                <ul class="nav" id="jsTOCLeftNav"></ul>
                            </div>
                        </div>
                    </nav>
                    <div class="col-toc">
                        <div class="sidebar hidden-xs hidden-sm">
                            <div class="toc-nav">
                                <div class="feedback-links">
                                    <ul><li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/edit/master/src/language/java/build-images.ch"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> 本ページの編集</a></li><li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/issues/new?body=File: [language/java/build-images.ch](https://matsuand.github.io/docs.docker.jp.onthefly/language/java/build-images/)" class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 変更リクエスト</a></li>
                                        <li><div class="toggle-mode">
  <div class="icon">
      <i class="fa fa-sun-o" aria-hidden="true"></i>
  </div>
  <div class="toggle-switch">
      <label class="switch">
          <input type="checkbox" id="switch-style">
          <span class="slider round"></span>
      </label>
  </div>
  <div class="icon">
      <i class="fa fa-moon-o" aria-hidden="true"></i>
  </div>
</div>
</li>
                                    </ul>
                                </div><div id="side-toc-title">本ページ内:</div>
<ul id="my_toc" class="inline_toc">
  <li><a href="#prerequisites" class="nomunge">Prerequisites</a>
    <ul>
      <li><a href="#enable-buildkit" class="nomunge">BuildKit の有効化</a></li>
    </ul>
  </li>
  <li><a href="#overview" class="nomunge">Overview</a></li>
  <li><a href="#sample-application" class="nomunge">Sample application</a></li>
  <li><a href="#test-the-application-without-docker-optional" class="nomunge">Test the application without Docker (optional)</a></li>
  <li><a href="#create-a-dockerfile-for-java" class="nomunge">Create a Dockerfile for Java</a>
    <ul>
      <li><a href="#create-a-dockerignore-file" class="nomunge">Create a .dockerignore file</a></li>
    </ul>
  </li>
  <li><a href="#build-an-image" class="nomunge">Build an image</a></li>
  <li><a href="#view-local-images" class="nomunge">View local images</a></li>
  <li><a href="#tag-images" class="nomunge">Tag images</a></li>
  <li><a href="#next-steps" class="nomunge">Next steps</a></li>
  <li><a href="#feedback" class="nomunge">Feedback</a></li>
</ul>

</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer class="footer">
          
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products" target="_blank" rel="noopener">製品ラインアップ</a></b></li>
                        <li><a href="https://www.docker.com/products/personal" target="_blank" rel="noopener">Docker Personal</a></li>
                        <li><a href="https://www.docker.com/products/pro" target="_blank" rel="noopener">Docker Pro</a></li>
                        <li><a href="https://www.docker.com/products/team" target="_blank" rel="noopener">Docker Team</a></li>
                        <li><a href="https://www.docker.com/products/business" target="_blank" rel="noopener">Docker Business</a></li>
                        <li><a href="https://www.docker.com/products" target="_blank" rel="noopener">サブスクリプション比較</a></li>
                        <li><b><a href="https://www.docker.com/" target="_blank" rel="noopener">機能</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="noopener">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub" target="_blank" rel="noopener">Docker Hub</a></li>
                        <li><a href="https://www.docker.com/products/secure-software-supply-chain" target="_blank" rel="noopener">セキュアなソフトウェアサプライチェーン</a></li>
                        <li><a href="https://www.docker.com/products/container-runtime" target="_blank" rel="noopener">コンテナーランタイム</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools" target="_blank" rel="noopener">開発ツール</a></li>
                        <li><a href="https://www.docker.com/partners" target="_blank" rel="noopener">信頼できるコンテント</a></li>
                        <li><a href="https://www.docker.com/roadmap" target="_blank" rel="noopener">Docker 製品ロードマップ</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="noopener">開発者</a></b></li>
                        <li><a href="https://www.docker.com/use-cases" target="_blank" rel="noopener">利用例</a></li>
                        <li><a href="https://docs.docker.com/get-started/" target="_blank" rel="noopener">はじめよう</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank" rel="noopener">ブログ</a></li>
                        <li><a href="https://www.docker.com/docker-community" target="_blank" rel="noopener">コミュニティー</a></li>
                        <li><a href="https://www.docker.com/open-source" target="_blank" rel="noopener">オープンソース</a></li>
                        <li><a href="https://www.docker.com/community/get-involved/developer-preview" target="_blank" rel="noopener">プレビュープログラム</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="noopener">価格体系</a></b></li>
                        <li><a href="https://www.docker.com/pricing/faq" target="_blank" rel="noopener">FAQ</a></li>
                        <li><a href="https://www.docker.com/partners/programs" target="_blank" rel="noopener">Docker 認定公開者向けプログラム</a></li>
                        <li><a href="https://www.docker.com/partners" target="_blank" rel="noopener">パートナー</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank" rel="noopener">会社概要</a></b></li>
                        <li><a href="https://www.docker.com/what-container" target="_blank" rel="noopener">コンテナーって何？</a></li>
                        <li><a href="https://www.docker.com/why-docker" target="_blank" rel="noopener">なぜ Docker？</a></li>
                        <li><a href="https://www.docker.com/events" target="_blank" rel="noopener">仮想イベント</a></li>
                        <li><a href="https://www.docker.com/swag" target="_blank" rel="noopener">Swag ストア
                        </a></li>
                        <li><a href="https://www.docker.com/company/newsroom" target="_blank" rel="noopener">ニュースルーム</a></li>
                        <li><a href="https://www.docker.com/careers" target="_blank" rel="noopener">採用情報</a></li>
                        <li><a href="https://www.docker.com/company/contact" target="_blank" rel="noopener">連絡先</a></li>
                        <li><a href="https://www.docker.com/customers" target="_blank" rel="noopener">顧客</a></li>
                        <li><a href="https://www.docker.com/newsletter-subscription" target="_blank" rel="noopener">ニュースレター</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="https://www.docker.com/legal/docker-terms-service" target="_blank" rel="noopener">サービス契約</a></li>
                        <li><a href="https://status.docker.com/" target="_blank" rel="noopener">ステータス</a></li>
                        <li><a href="https://www.docker.com/legal" target="_blank" rel="noopener">法的情報</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2013-2021 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="https://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="https://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

    </footer>
    <script>const pageURL = "/language/java/build-images/";</script></body>
</html>
