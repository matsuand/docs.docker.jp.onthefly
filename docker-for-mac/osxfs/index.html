<!-- Page generated 2020-04-13 12:18:52 +0900 -->
<!-- relative link basehrefs -->

	
	
	
		
			
		
	
		
			
			


<!-- Logic for 'edit this button' -->


	

	

	

	

	

	

	

	


<!-- End of logic for 'edit this button' -->


<!DOCTYPE html>
<html lang="ja">

<head>
	<base href="/docs.docker.jp.onthefly/docker-for-mac/" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<style type="text/css">
		@charset "UTF-8";
		[ng\:cloak],
		[ng-cloak],
		[data-ng-cloak],
		[x-ng-cloak],
		.ng-cloak,
		.x-ng-cloak,
		.ng-hide:not(.ng-hide-animate) {
			display: none !important;
		}

		ng\:form {
			display: block;
		}
	</style>
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-WL2QLG5');</script>
	<!-- End Google Tag Manager -->
	
	<!-- favicon -->
	<link rel="icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta name="msapplication-TileImage" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico">
	<link rel="apple-touch-icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta property="og:image" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
	<!-- metadata -->
	<meta property="og:type" content="website"/>
	<meta property="og:updated_time" itemprop="dateUpdated" content="2020-04-13T12:18:52+09:00"/>
	<meta property="og:image" itemprop="image primaryImageOfPage" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:card" content="summary"/>
	<meta name="twitter:domain" content="docs.docker.jp"/>
	<meta name="twitter:site" content="@docker_docs"/>
	<meta name="twitter:url" content="https://twitter.com/docker_docs"/>
	<meta name="twitter:title" itemprop="title name" content="File system sharing (osxfs)"/>
	<meta name="twitter:description" property="og:description" itemprop="description" content="osxfs is a new shared file system solution, exclusive to Docker Desktop for Mac. osxfs provides a close-to-native user experience for bind mounting macOS file system trees into Docker containers...." />
	<meta name="twitter:image:src" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:image:alt" content="Docker ドキュメント"/>
	<meta property="article:published_time" itemprop="datePublished" content="2020-04-13T12:18:52+09:00"/>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="keywords" content="mac, osxfs">
	<link rel="stylesheet" href="/docs.docker.jp.onthefly/css/font-awesome.min.css">
	<link rel="stylesheet" href="/docs.docker.jp.onthefly/css/bootstrap.min.css">
	<link id="pygments" rel="stylesheet" href="/docs.docker.jp.onthefly/css/pygments/perldoc.css">
	<link id="pagestyle" rel="stylesheet" href="/docs.docker.jp.onthefly/css/style.css">

	<!-- Go get "Open Sans" font from Google -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	<!-- SEO stuff -->
	<title>File system sharing (osxfs) | Docker ドキュメント</title>
<meta property="og:title" content="File system sharing (osxfs)" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="Osxfs" />
<meta property="og:description" content="Osxfs" />
<link rel="canonical" href="/docs.docker.jp.onthefly/docker-for-mac/osxfs/" />
<meta property="og:url" content="https://matsuand.github.io/docs.docker.jp.onthefly/docker-for-mac/osxfs/" />
<meta property="og:site_name" content="Docker ドキュメント" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"File system sharing (osxfs)","description":"Osxfs","url":"https://matsuand.github.io/docs.docker.jp.onthefly/docker-for-mac/osxfs/"}</script>
	<!-- END SEO STUFF -->
	
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03';
	</script>
</head>
<body ng-app="Docker" ng-controller="DockerController" class="colums">
	<header>
		 <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/docs.docker.jp.onthefly/"><img class="logo" src="/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v19.03 (current)     <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="/docs.docker.jp.onthefly/v18.09/">Docker v18.09</a></li><li><a href="/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

	</header>

	<div class="wrapper right-open">
		<div class="container-fluid">
			<div class="row">
				<div class="col-body">
					<main class="col-content content">
						<section class="section">
							
								
							<h1>File system sharing (osxfs)</h1>  <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    15 分
  
</span>

							
							
							<p><code class="highlighter-rouge">osxfs</code> is a new shared file system solution, exclusive to Docker Desktop for Mac.
<code class="highlighter-rouge">osxfs</code> provides a close-to-native user experience for bind mounting macOS file
system trees into Docker containers. To this end, <code class="highlighter-rouge">osxfs</code> features a number of
unique capabilities as well as differences from a classical Linux file system.</p>

<h3 id="case-sensitivity">Case sensitivity</h3>

<p>With Docker Desktop for Mac, file systems operate in containers in the same way as they
operate in macOS. If a file system on macOS is case-insensitive, that behavior
is shared by any bind mount from macOS into a container.</p>

<p>On macOS Sierra and lower, the default file system is <strong>HFS+</strong>. On macOS High
Sierra, the default file system is <strong>APFS</strong>. Both are case-insensitive by
default but available in case-sensitive and case-insensitive variants.</p>

<p>To get case-sensitive behavior, format the volume used in your bind mount as
HFS+ or APFS with case-sensitivity. See the
<a href="https://developer.apple.com/library/content/documentation/FileManagement/Conceptual/APFS_Guide/FAQ/FAQ.html">APFS FAQ</a>.</p>

<p>Reformatting your root partition is not recommended as some Mac software relies
on case-insensitivity to function.</p>

<h3 id="access-control">Access control</h3>

<p><code class="highlighter-rouge">osxfs</code>, and therefore Docker, can access only those file system resources that
the Docker Desktop for Mac user has access to. <code class="highlighter-rouge">osxfs</code> does not run as <code class="highlighter-rouge">root</code>. If the macOS
user is an administrator, <code class="highlighter-rouge">osxfs</code> inherits those administrator privileges. We
are still evaluating which privileges to drop in the file system process to
balance security and ease-of-use. <code class="highlighter-rouge">osxfs</code> performs no additional permissions
checks and enforces no extra access control on accesses made through it. All
processes in containers can access the same objects in the same way as the
Docker user who started the containers.</p>

<h3 id="namespaces">Namespaces</h3>

<p>Much of the macOS file system that is accessible to the user is also available to
containers using the <code class="highlighter-rouge">-v</code> bind mount syntax. The following command runs a container
from an image called <code class="highlighter-rouge">r-base</code> and shares the macOS user’s <code class="highlighter-rouge">~/Desktop/</code> directory as
<code class="highlighter-rouge">/Desktop</code> in the container.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker run <span class="nt">-it</span> <span class="nt">-v</span> ~/Desktop:/Desktop r-base bash
</code></pre></div></div>

<p>The user’s <code class="highlighter-rouge">~/Desktop/</code> directory is now visible in the container as a directory
under <code class="highlighter-rouge">/</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@2h30fa0c600e:/# ls
Desktop	boot	etc	lib	lib64	media	opt	root	sbin	sys	usr
bin	dev	home	lib32	libx32	mnt	proc	run	srv	tmp	var
</code></pre></div></div>

<p>By default, you can share files in <code class="highlighter-rouge">/Users/</code>, <code class="highlighter-rouge">/Volumes/</code>, <code class="highlighter-rouge">/private/</code>, and
<code class="highlighter-rouge">/tmp</code> directly. To add or remove directory trees that are exported to Docker,
use the <strong>File sharing</strong> tab in Docker preferences <img src="/docs.docker.jp.onthefly/docker-for-mac/images/whale-x.png" alt="whale
menu" class="inline" /> -&gt; <strong>Preferences</strong> -&gt;
<strong>File sharing</strong>. (See <a href="/docs.docker.jp.onthefly/docker-for-mac/index.md#preferences-menu">Preferences</a>.)</p>

<p>All other paths
used in <code class="highlighter-rouge">-v</code> bind mounts are sourced from the Moby Linux VM running the Docker
containers, so arguments such as <code class="highlighter-rouge">-v /var/run/docker.sock:/var/run/docker.sock</code>
should work as expected. If a macOS path is not shared and does not exist in the
VM, an attempt to bind mount it fails rather than create it in the VM. Paths
that already exist in the VM and contain files are reserved by Docker and cannot
be exported from macOS.</p>

<blockquote>
  <p>See <strong><a href="/docs.docker.jp.onthefly/docker-for-mac/osxfs-caching/">Performance tuning for volume mounts (shared filesystems)</a></strong>
to learn about new configuration options available with the Docker 17.04 CE Edge release.</p>
</blockquote>

<h3 id="ownership">Ownership</h3>

<p>Initially, any containerized process that requests ownership metadata of an
object is told that its <code class="highlighter-rouge">uid</code> and <code class="highlighter-rouge">gid</code> own the object. When any containerized
process changes the ownership of a shared file system object, such as by using
the <code class="highlighter-rouge">chown</code> command, the new ownership information is persisted in the
<code class="highlighter-rouge">com.docker.owner</code> extended attribute of the object. Subsequent requests for
ownership metadata return the previously set values. Ownership-based permissions
are only enforced at the macOS file system level with all accessing processes
behaving as the user running Docker. If the user does not have permission to
read extended attributes on an object (such as when that object’s permissions
are <code class="highlighter-rouge">0000</code>), <code class="highlighter-rouge">osxfs</code> attempts to add an access control list (ACL) entry that
allows the user to read and write extended attributes. If this attempt fails,
the object appears to be owned by the process accessing it until the extended
attribute is readable again.</p>

<h3 id="file-system-events">File system events</h3>

<p>Most <code class="highlighter-rouge">inotify</code> events are supported in bind mounts, and likely <code class="highlighter-rouge">dnotify</code> and
<code class="highlighter-rouge">fanotify</code> (though they have not been tested) are also supported. This means
that file system events from macOS are sent into containers and trigger any
listening processes there.</p>

<p>The following are <strong>supported file system events</strong>:</p>

<ul>
  <li>Creation</li>
  <li>Modification</li>
  <li>Attribute changes</li>
  <li>Deletion</li>
  <li>Directory changes</li>
</ul>

<p>The following are <strong>partially supported file system events</strong>:</p>

<ul>
  <li>Move events trigger <code class="highlighter-rouge">IN_DELETE</code> on the source of the rename and
<code class="highlighter-rouge">IN_MODIFY</code> on the destination of the rename</li>
</ul>

<p>The following are <strong>unsupported file system events</strong>:</p>

<ul>
  <li>Open</li>
  <li>Access</li>
  <li>Close events</li>
  <li>Unmount events (see <a href="osxfs.md#mounts">Mounts</a>)</li>
</ul>

<p>Some events may be delivered multiple times. These limitations do not apply to
events between containers, only to those events originating in macOS.</p>

<h3 id="mounts">Mounts</h3>

<p>The macOS mount structure is not visible in the shared volume, but volume
contents are visible. Volume contents appear in the same file system as the rest
of the shared file system. Mounting/unmounting macOS volumes that are also bind
mounted into containers may result in unexpected behavior in those containers.
Unmount events are not supported. Mount export support is planned but is still
under development.</p>

<h3 id="symlinks">Symlinks</h3>

<p>Symlinks are shared unmodified. This may cause issues when symlinks contain
paths that rely on the default case-insensitivity of the default macOS file
system.</p>

<h3 id="file-types">File types</h3>

<p>Symlinks, hardlinks, socket files, named pipes, regular files, and directories
are supported. Socket files and named pipes only transmit between containers and
between macOS processes -- no transmission across the hypervisor is supported,
yet. Character and block device files are not supported.</p>

<h3 id="extended-attributes">Extended attributes</h3>

<p>Extended attributes are not yet supported.</p>

<h3 id="technology">Technology</h3>

<p><code class="highlighter-rouge">osxfs</code> does not use OSXFUSE. <code class="highlighter-rouge">osxfs</code> does not run under, inside, or
between macOS userspace processes and the macOS kernel.</p>

<h3 id="ssh-agent-forwarding">SSH agent forwarding</h3>

<p>Docker Desktop for Mac allows you to use the host’s SSH agent inside a container. To do this:</p>

<ol>
  <li>
    <p>Bind mount the SSH agent socket by adding the following parameter to your <code class="highlighter-rouge">docker run</code> command:</p>

    <p><code class="highlighter-rouge">--mount type=bind,src=/run/host-services/ssh-auth.sock,target=/run/host-services/ssh-auth.sock</code></p>
  </li>
  <li>
    <p>Add the <code class="highlighter-rouge">SSH_AUTH_SOCK</code> environment variable in your container:</p>

    <p><code class="highlighter-rouge">-e SSH_AUTH_SOCK="/run/host-services/ssh-auth.sock"</code></p>
  </li>
</ol>

<p>To enable the SSH agent in Docker Compose, add the following flags to your service:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">services</span><span class="pi">:</span>
  <span class="na">web</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">nginx:alpine</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">bind</span>
        <span class="na">source</span><span class="pi">:</span> <span class="s">/run/host-services/ssh-auth.sock</span>
        <span class="na">target</span><span class="pi">:</span> <span class="s">/run/host-services/ssh-auth.sock</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">SSH_AUTH_SOCK=/run/host-services/ssh-auth.sock</span>
</code></pre></div></div>

<h3 id="performance-issues-solutions-and-roadmap">Performance issues, solutions, and roadmap</h3>

<blockquote>
  <p>See <strong><a href="/docs.docker.jp.onthefly/docker-for-mac/osxfs-caching/">Performance tuning for volume mounts (shared filesystems)</a></strong>
to learn about new configuration options available with the Docker 17.04 CE Edge release.</p>
</blockquote>

<p>With regard to reported performance issues (<a href="https://github.com/docker/for-mac/issues/77">GitHub issue 77: File access in
mounted volumes extremely slow</a>),
and a similar thread on <a href="https://forums.docker.com/t/file-access-in-mounted-volumes-extremely-slow-cpu-bound/">Docker Desktop for Mac forums on topic: File access in mounted
volumes extremely
slow</a>,
this topic provides an explanation of the issues, recent progress in addressing
them, how the community can help us, and what you can expect in the
future. This explanation derives from a <a href="https://forums.docker.com/t/file-access-in-mounted-volumes-extremely-slow-cpu-bound/8076/158">post about understanding
performance</a>
by David Sheets (@dsheets) on the <a href="https://forums.docker.com/groups/Docker">Docker development
team</a> to the forum topic just
mentioned. We want to surface it in the documentation for wider reach.</p>

<h4 id="understanding-performance">Understanding performance</h4>

<p>Perhaps the most important thing to understand is that shared file system
performance is multi-dimensional. This means that, depending on your workload,
you may experience exceptional, adequate, or poor performance with <code class="highlighter-rouge">osxfs</code>, the
file system server in Docker Desktop for Mac. File system APIs are very wide (20-40
message types) with many intricate semantics  involving on-disk state, in-memory
cache state, and concurrent access by multiple  processes. Additionally, <code class="highlighter-rouge">osxfs</code>
integrates a mapping between macOS’s FSEvents API and Linux’s <code class="highlighter-rouge">inotify</code> API
which is implemented inside of the file system itself, complicating matters
further (cache behavior in particular).</p>

<p>At the highest level, there are two dimensions to file system performance:
throughput (read/write IO) and latency (roundtrip time). In a traditional file
system on a modern SSD, applications can generally expect throughput of a few
GB/s. With large sequential IO operations, <code class="highlighter-rouge">osxfs</code> can achieve throughput of
around 250 MB/s which, while not native speed, is not likely to be the bottleneck for
most applications which perform acceptably on HDDs.</p>

<p>Latency is the time it takes for a file system call to complete. For instance,
the time between a thread issuing write in a container and resuming with the
number of bytes written. With a classical block-based file system, this latency
is typically under 10μs (microseconds). With <code class="highlighter-rouge">osxfs</code>, latency is presently
around 130μs for most operations or 13× slower. For workloads which demand many
sequential roundtrips, this results in significant observable slowdown.
Reducing the latency requires shortening the data path from a Linux system call to
macOS and back again. This requires tuning each component in the data path in
turn -- some of which require significant engineering effort. Even if we achieve
a huge latency reduction of 65μs/roundtrip, we still “only” see a doubling
of performance. This is typical of performance engineering, which requires
significant effort to analyze slowdowns and develop optimized components. We
know a number of approaches that may reduce the roundtrip time but we
haven’t implemented all those improvements yet (more on this below in
<a href="/docs.docker.jp.onthefly/docker-for-mac/osxfs/#what-you-can-do">What you can do</a>).</p>

<p>A second approach to improving performance is to reduce the number of
roundtrips by caching data.  Recent versions of Docker Desktop for Mac (17.04 onwards)
include caching support that brings significant (2-4×) improvements to many
applications.  Much of the overhead of osxfs arises from the requirement to
keep the container’s and the host’s view of the file system consistent, but
full consistency is not necessary for all applications and relaxing the
constraint opens up a number of opportunities for improved performance.</p>

<p>At present there is support for read caching, with which the container’s view
of the file system can temporarily drift apart from the authoritative view on
the host.  Further caching developments, including support for write caching,
are planned.
A <a href="osxfs-caching">detailed description of the behavior in various caching configurations</a>
is available.</p>

<h4 id="what-we-are-doing">What we are doing</h4>

<p>We continue to actively work on increasing caching and on reducing the
file system data path latency. This requires significant analysis of file
system traces and speculative development of system improvements to try to
address specific performance issues. Perhaps surprisingly, application
workload can have a huge effect on performance. As an example, here are two
different use cases contributed on the
<a href="https://forums.docker.com/t/file-access-in-mounted-volumes-extremely-slow-cpu-bound/">forum topic</a>
and how their performance differs and suffers due to latency, caching, and
coherence:</p>

<ol>
  <li>
    <p>A rake example (see below) appears to attempt to access 37000+
different files that don’t exist on the shared volume. Even with a 2× speedup
via latency reduction this use case still seems “slow”.
With caching enabled the performance increases around 3.5×, as described in
the <a href="https://blog.docker.com/2017/05/user-guided-caching-in-docker-for-mac/">user-guided caching post</a>.
We expect to see further performance improvements for rake with a “negative dcache” that
keeps track of, in the Linux kernel itself, the files that do not exist.
However, even this is not sufficient for the first time rake is run on a
shared directory. To handle that case, we actually need to develop a Linux
kernel patch which negatively caches all directory entries not in a
specified set -- and this cache must be kept up-to-date in real-time with the macOS
file system state even in the presence of missing macOS FSEvents messages and
so must be invalidated if macOS ever reports an event delivery failure.</p>
  </li>
  <li>
    <p>Running <code class="highlighter-rouge">ember build</code> in a shared file system results in ember creating many
different temporary directories and performing lots of intermediate activity
within them. An empty ember project is over 300MB. This usage pattern does not
require coherence between Linux and macOS, and is significantly improved by
write caching.</p>
  </li>
</ol>

<p>These two examples come from performance use cases contributed by users and they
are incredibly helpful in prioritizing aspects of file system performance to
improve. We are developing statistical file system trace analysis tools
to characterize slow-performing workloads more easily to decide what to
work on next.</p>

<p>Under development, we have:</p>

<ol>
  <li>
    <p>A growing performance test suite of real world use cases (more on this below
in What you can do)</p>
  </li>
  <li>
    <p>Further caching improvements, including negative, structural, and write-back
caching, and lazy cache invalidation.</p>
  </li>
  <li>
    <p>A Linux kernel patch to reduce data path latency by 2/7 copies and 2/5
context switches</p>
  </li>
  <li>
    <p>Increased macOS integration to reduce the latency between the hypervisor and
the file system server</p>
  </li>
</ol>

<h4 id="what-you-can-do">What you can do</h4>

<p>When you report shared file system performance issues, it is most helpful to
include a minimal Real World reproduction test case that demonstrates poor
performance.</p>

<p>Without a reproduction, it is very difficult for us to analyze your use case and
determine what improvements would speed it up. When you don’t provide a
reproduction, one of us needs to figure out the specific software
you are using and guess and hope that we have configured it in a typical way or
a way that has poor performance. That usually takes 1-4 hours depending on your
use case and once it is done, we must then determine what regular performance is
like and what kind of slow-down your use case is experiencing. In some cases, it
is not obvious what operation is even slow in your specific development
workflow. The additional set-up to reproduce the problem means we have less time
to fix bugs, develop analysis tools, or improve performance. So, include
simple, immediate performance issue reproduction test cases. The <a href="https://forums.docker.com/t/file-access-in-mounted-volumes-extremely-slow-cpu-bound/8076/103">rake
reproduction
case</a>
by @hirowatari shown in the forums thread is a great example.</p>

<p>This example originally provided:</p>

<ol>
  <li>
    <p>A version-controlled repository so any changes/improvements to the test case
can be easily tracked.</p>
  </li>
  <li>
    <p>A Dockerfile which constructs the exact image to run</p>
  </li>
  <li>
    <p>A command-line invocation of how to start the container</p>
  </li>
  <li>
    <p>A straight-forward way to measure the performance of the use case</p>
  </li>
  <li>
    <p>A clear explanation (README) of how to run the test case</p>
  </li>
</ol>

<h4 id="what-you-can-expect">What you can expect</h4>

<p>We continue to work toward an optimized shared file system implementation
on the Edge channel of Docker Desktop for Mac.</p>

<p>You can expect some of the performance improvement work mentioned above to reach
the Edge channel in the coming release cycles.</p>

<p>We plan to eventually open source all of our shared file system components. At
that time, we would be very happy to collaborate with you on improving the
implementation of <code class="highlighter-rouge">osxfs</code> and related software.</p>

<p>We also plan to write up and publish further details of shared file system
performance analysis and improvement on the Docker blog. Look for or nudge
@dsheets about those articles, which should serve as a jumping off point for
understanding the system, measuring it, or contributing to it.</p>

<h4 id="wrapping-up">Wrapping Up</h4>

<p>We hope this gives you a rough idea of where <code class="highlighter-rouge">osxfs</code> performance is and where
it’s going. We are treating good performance as a top priority feature of the
file system sharing component and we are actively working on improving it
through a number of different avenues. The osxfs project started in December</p>
<ol>
  <li>Since the first integration into Docker Desktop for Mac in February 2016, we’ve
improved performance by 50x or more for many workloads while achieving nearly
complete POSIX compliance and without compromising coherence (it is shared and
not simply synced). Of course, in the beginning there was lots of low-hanging
fruit and now many of the remaining performance improvements require significant
engineering work on custom low-level components.</li>
</ol>

<p>We appreciate your understanding as we continue development of the product and
work on all dimensions of performance. We want to continue to work with the
community on this, so continue to report issues as you find them. We look
forward to collaborating with you on ideas and on the source code itself.</p>

							<!-- tags -->
							
							<span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="https://matsuand.github.io/docs.docker.jp.onthefly/search/?q=mac">mac</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/search/?q=osxfs">osxfs</a></span>
							
							<!-- link corrections -->
              <script language="JavaScript">
							var x = document.links.length;
							var baseHref = document.getElementsByTagName('base')[0].href
							for (i = 0; i < x; i++) {
							  var munged = false;
							  var thisHREF = document.links[i].href;
							  var originalURL = "/docker-for-mac/osxfs/";
							  if (thisHREF.indexOf(baseHref + "#") > -1) {
							    // hash fix
							    //console.log('BEFORE: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							    thisHREF = originalURL + thisHREF.replace(baseHref, "");
							    //console.log('AFTER: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							  }
							  if ((thisHREF.indexOf(window.location.hostname) > -1 || thisHREF.indexOf('http') == -1) && document.links[i].className.indexOf("nomunge") < 0) {
							    munged = true;
							    thisHREF = thisHREF.replace(".md", "/").replace("/index/", "/");
							    document.links[i].setAttribute('href', thisHREF);
							  }
							}
							</script>
							
						  <div id="ratings-div" style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
								<div id="pd_rating_holder_8453675"></div>
								<script type="text/javascript">
									PDRTJS_settings_8453675 = {
										"id": "8453675",
										"unique_id": "docker-for-mac/osxfs.md",
										"title": "File system sharing (osxfs)",
										"permalink": "https://github.com/docker/docker.github.io/blob/master/docker-for-mac/osxfs.md"
									};
									(function(d, c, j) {
										if (!document.getElementById(j)) {
											var pd = d.createElement(c),
												s;
											pd.id = j;
											pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
											s = document.getElementsByTagName(c)[0];
											s.parentNode.insertBefore(pd, s);
										}
									}(document, 'script', 'pd-rating-js'));
								</script>
							</div>
							
						</section>
					</main>
					<nav class="col-nav">
						<div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
						<div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

						</div>
					</nav>
					<div class="col-toc">
							<div class="sidebar hidden-xs hidden-sm">
							<div class="toc-nav">
								<div class="feedback-links">
									<ul>
										
										<li style="visibility: hidden"><a href="https://github.com/matsuand/docs.docker.jp/edit/v19.03.local/docker-for-mac/osxfs.md"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
										<li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/issues/new?body=File: [docker-for-mac/osxfs.md](https://matsuand.github.io/docs.docker.jp.onthefly/docker-for-mac/osxfs/)"
															class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
										<!-- toggle mode -->
										<li>
											<div class="toggle-mode">
												<div class="icon">
													<i class="fa fa-sun-o" aria-hidden="true"></i>
												</div>
												<div class="toggle-switch">
													<label class="switch">
														<input type="checkbox" id="switch-style">
														<div class="slider round"></div>
												</label>
												</div>
												<div class="icon">
													<i class="fa fa-moon-o" aria-hidden="true"></i>
												</div>
											</div>
										</li>
									</ul>
								</div>
								   
									<div id="side-toc-title">本ページ内</div>
									
<ul id="my_toc" class="inline_toc">
  <li><a href="/docs.docker.jp.onthefly/osxfs.md#case-sensitivity" class="nomunge">Case sensitivity</a>
    <ul>
      <li><a href="/docs.docker.jp.onthefly/osxfs.md#access-control" class="nomunge">Access control</a></li>
      <li><a href="/docs.docker.jp.onthefly/osxfs.md#namespaces" class="nomunge">Namespaces</a></li>
      <li><a href="/docs.docker.jp.onthefly/osxfs.md#ownership" class="nomunge">Ownership</a></li>
      <li><a href="/docs.docker.jp.onthefly/osxfs.md#file-system-events" class="nomunge">File system events</a></li>
      <li><a href="/docs.docker.jp.onthefly/osxfs.md#mounts" class="nomunge">Mounts</a></li>
      <li><a href="/docs.docker.jp.onthefly/osxfs.md#symlinks" class="nomunge">Symlinks</a></li>
      <li><a href="/docs.docker.jp.onthefly/osxfs.md#file-types" class="nomunge">File types</a></li>
      <li><a href="/docs.docker.jp.onthefly/osxfs.md#extended-attributes" class="nomunge">Extended attributes</a></li>
      <li><a href="/docs.docker.jp.onthefly/osxfs.md#technology" class="nomunge">Technology</a></li>
      <li><a href="/docs.docker.jp.onthefly/osxfs.md#ssh-agent-forwarding" class="nomunge">SSH agent forwarding</a></li>
      <li><a href="/docs.docker.jp.onthefly/osxfs.md#performance-issues-solutions-and-roadmap" class="nomunge">Performance issues, solutions, and roadmap</a></li>
    </ul>
  </li>
</ul>


								</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	
	<footer class="footer">
		  
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/why-docker">Why Docker</a></b></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/overview">Products</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub">Docker Hub</a></li>
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Features</a></b></li>
                        <li><a href="https://www.docker.com/products/container-runtime">Container Runtime</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools">Developer Tools</a></li>
                        <li><a href="https://www.docker.com/products/kubernetes">Kubernetes</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Developers</a></b></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/play-with-docker">Play with Docker</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/open-source">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank">Company</a></b></li>
                        <li><a href="https://www.docker.com/company">About Us</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank">Blog</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners">Partners</a></li>
                        <li><a href="https://www.docker.com/company/newsroom">Newsroom</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2013-2020 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

	</footer>
	<link rel="stylesheet" href="/docs.docker.jp.onthefly/css/github.css">
	
	<script defer src="/docs.docker.jp.onthefly/js/anchorlinks.js"></script>
	<script defer src="/docs.docker.jp.onthefly/js/menu.js"></script>
	<script src="/docs.docker.jp.onthefly/js/jquery.js"></script>
	<script src="/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
	<!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03';
	// In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
	var jekyllEnv = 'development';
	// If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
	if (jekyllEnv == 'development') {
		jekyllEnv = '';
	}
	var pageURL = jekyllEnv + '/docker-for-mac/osxfs/';
	</script>
	<script src="/docs.docker.jp.onthefly/js/archive.js"></script>
	<script src="/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
	<script defer src="/docs.docker.jp.onthefly/js/metadata.js"></script>
	<script src="/docs.docker.jp.onthefly/js/glossary.js"></script>
	<script defer src="/docs.docker.jp.onthefly/js/docs.js"></script>
	<script defer src="/docs.docker.jp.onthefly/js/toc.js"></script>
	<script language="javascript">
	jQuery(document).ready(function(){
				hookupTOCEvents();
			});
	</script>
</body>

</html>
