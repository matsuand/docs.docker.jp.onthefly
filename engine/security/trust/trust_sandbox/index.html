<!-- Page generated 2019-09-11 17:40:27 +0900 -->
<!-- relative link basehrefs -->

	
	
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
			


<!-- Logic for 'edit this button' -->


	

	

	

	

	

	

	

	

	


<!-- End of logic for 'edit this button' -->


<!DOCTYPE html>
<html lang="ja">

<head>
	<base href="https://matsuand.github.io/docs.docker.jp.onthefly/engine/security/trust/" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<style type="text/css">
		@charset "UTF-8";
		[ng\:cloak],
		[ng-cloak],
		[data-ng-cloak],
		[x-ng-cloak],
		.ng-cloak,
		.x-ng-cloak,
		.ng-hide:not(.ng-hide-animate) {
			display: none !important;
		}

		ng\:form {
			display: block;
		}
	</style>
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-WL2QLG5');</script>
	<!-- End Google Tag Manager -->
	
	<!-- favicon -->
	<link rel="icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta name="msapplication-TileImage" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico">
	<link rel="apple-touch-icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta property="og:image" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
	<!-- metadata -->
	<meta property="og:type" content="website"/>
	<meta property="og:updated_time" itemprop="dateUpdated" content="2019-09-11T17:40:27+09:00"/>
	<meta property="og:image" itemprop="image primaryImageOfPage" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:card" content="summary"/>
	<meta name="twitter:domain" content="docs.docker.jp"/>
	<meta name="twitter:site" content="@docker_docs"/>
	<meta name="twitter:url" content="https://twitter.com/docker_docs"/>
	<meta name="twitter:title" itemprop="title name" content="Play in a content trust sandbox"/>
	<meta name="twitter:description" property="og:description" itemprop="description" content="This page explains how to set up and use a sandbox for experimenting with trust. The sandbox allows you to configure and try trust operations locally without impacting your production..." />
	<meta name="twitter:image:src" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:image:alt" content="Docker ドキュメント"/>
	<meta property="article:published_time" itemprop="datePublished" content="2019-09-11T17:40:27+09:00"/>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="keywords" content="trust, security, root,  keys, repository, sandbox">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/bootstrap.min.css">
	<link id="pygments" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/pygments/perldoc.css">
	<link id="pagestyle" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/style.css">

	<!-- Go get "Open Sans" font from Google -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	<!-- SEO stuff -->
	<title>Play in a content trust sandbox | Docker ドキュメント</title>
<meta property="og:title" content="Play in a content trust sandbox" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="Play in a trust sandbox" />
<meta property="og:description" content="Play in a trust sandbox" />
<link rel="canonical" href="https://matsuand.github.io/docs.docker.jp.onthefly/engine/security/trust/trust_sandbox/" />
<meta property="og:url" content="https://matsuand.github.io/docs.docker.jp.onthefly/engine/security/trust/trust_sandbox/" />
<meta property="og:site_name" content="Docker ドキュメント" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"Play in a content trust sandbox","description":"Play in a trust sandbox","url":"https://matsuand.github.io/docs.docker.jp.onthefly/engine/security/trust/trust_sandbox/"}</script>
	<!-- END SEO STUFF -->
	
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03';
	</script>
</head>
<body ng-app="Docker" ng-controller="DockerController" class="colums">
	<header>
		 <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="https://matsuand.github.io/docs.docker.jp.onthefly/"><img class="logo" src="https://matsuand.github.io/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="https://matsuand.github.io/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v19.03 (current)         <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/edge/">Docker edge</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.09/">Docker v18.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.12/">Docker v17.12</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.09/">Docker v17.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.03/">Docker v17.03</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

	</header>

	<div class="wrapper right-open">
		<div class="container-fluid">
			<div class="row">
				<div class="col-body">
					<main class="col-content content">
						<section class="section">
							
								
							<h1>Play in a content trust sandbox</h1>  <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    8 分
  
</span>

							
							
							<p>This page explains how to set up and use a sandbox for experimenting with trust.
The sandbox allows you to configure and try trust operations locally without
impacting your production images.</p>

<p>Before working through this sandbox, you should have read through the <a href="https://matsuand.github.io/docs.docker.jp.onthefly/engine/security/trust/content_trust/">trust
overview</a>.</p>

<h3 id="prerequisites">Prerequisites</h3>

<p>These instructions assume you are running in Linux or macOS. You can run
this sandbox on a local machine or on a virtual machine. You need to
have privileges to run docker commands on your local machine or in the VM.</p>

<p>This sandbox requires you to install two Docker tools: Docker Engine &gt;= 1.10.0
and Docker Compose &gt;= 1.6.0. To install the Docker Engine, choose from the
<a href="../../installation/index.md">list of supported platforms</a>. To install
Docker Compose, see the
<a href="https://matsuand.github.io/docs.docker.jp.onthefly/compose/install/">detailed instructions here</a>.</p>

<h2 id="what-is-in-the-sandbox">What is in the sandbox?</h2>

<p>If you are just using trust out-of-the-box you only need your Docker Engine
client and access to the Docker Hub. The sandbox mimics a
production trust environment, and sets up these additional components.</p>

<table>
  <thead>
    <tr>
      <th>Container</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>trustsandbox</td>
      <td>A container with the latest version of Docker Engine and with some preconfigured certificates. This is your sandbox where you can use the <code class="highlighter-rouge">docker</code> client to test trust operations.</td>
    </tr>
    <tr>
      <td>Registry server</td>
      <td>A local registry service.</td>
    </tr>
    <tr>
      <td>Notary server</td>
      <td>The service that does all the heavy-lifting of managing trust</td>
    </tr>
  </tbody>
</table>

<p>This means you run your own content trust (Notary) server and registry.
If you work exclusively with the Docker Hub, you would not need with these components.
They are built into the Docker Hub for you. For the sandbox, however, you build
your own entire, mock production environment.</p>

<p>Within the <code class="highlighter-rouge">trustsandbox</code> container, you interact with your local registry rather
than the Docker Hub. This means your everyday image repositories are not used.
They are protected while you play.</p>

<p>When you play in the sandbox, you also create root and repository keys. The
sandbox is configured to store all the keys and files inside the <code class="highlighter-rouge">trustsandbox</code>
container. Since the keys you create in the sandbox are for play only,
destroying the container destroys them as well.</p>

<p>By using a docker-in-docker image for the <code class="highlighter-rouge">trustsandbox</code> container, you also
don’t pollute your real Docker daemon cache with any images you push and pull.
The images are stored in an anonymous volume attached to this container,
and can be destroyed after you destroy the container.</p>

<h2 id="build-the-sandbox">Build the sandbox</h2>

<p>In this section, you use Docker Compose to specify how to set up and link together
the <code class="highlighter-rouge">trustsandbox</code> container, the Notary server, and the Registry server.</p>

<ol>
  <li>
    <p>Create a new <code class="highlighter-rouge">trustsandbox</code> directory and change into it.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ mkdir trustsandbox
 $ cd trustsandbox
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create a file called <code class="highlighter-rouge">docker-compose.yml</code> with your favorite editor.  For example, using vim:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ touch docker-compose.yml
 $ vim docker-compose.yml
</code></pre></div>    </div>
  </li>
  <li>
    <p>Add the following to the new file.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> version: "2"
 services:
   notaryserver:
     image: dockersecurity/notary_autobuilds:server-v0.5.1
     volumes:
       - notarycerts:/var/lib/notary/fixtures
     networks:
       - sandbox
     environment:
       - NOTARY_SERVER_STORAGE_TYPE=memory
       - NOTARY_SERVER_TRUST_SERVICE_TYPE=local
   sandboxregistry:
     image: registry:2.4.1
     networks:
       - sandbox
     container_name: sandboxregistry
   trustsandbox:
     image: docker:dind
     networks:
       - sandbox
     volumes:
       - notarycerts:/notarycerts
     privileged: true
     container_name: trustsandbox
     entrypoint: ""
     command: |-
         sh -c '
             cp /notarycerts/root-ca.crt /usr/local/share/ca-certificates/root-ca.crt &amp;&amp;
             update-ca-certificates &amp;&amp;
             dockerd-entrypoint.sh --insecure-registry sandboxregistry:5000'
 volumes:
   notarycerts:
     external: false
 networks:
   sandbox:
     external: false
</code></pre></div>    </div>
  </li>
  <li>
    <p>Save and close the file.</p>
  </li>
  <li>
    <p>Run the containers on your local system.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ docker-compose up -d
</code></pre></div>    </div>

    <p>The first time you run this, the docker-in-docker, Notary server, and registry
 images are downloaded from Docker Hub.</p>
  </li>
</ol>

<h2 id="play-in-the-sandbox">Play in the sandbox</h2>

<p>Now that everything is setup, you can go into your <code class="highlighter-rouge">trustsandbox</code> container and
start testing Docker content trust. From your host machine, obtain a shell
in the <code class="highlighter-rouge">trustsandbox</code> container.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker container exec -it trustsandbox sh
/ #
</code></pre></div></div>

<h3 id="test-some-trust-operations">Test some trust operations</h3>

<p>Now, pull some images from within the <code class="highlighter-rouge">trustsandbox</code> container.</p>

<ol>
  <li>
    <p>Download a <code class="highlighter-rouge">docker</code> image to test with.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> / # docker pull docker/trusttest
 docker pull docker/trusttest
 Using default tag: latest
 latest: Pulling from docker/trusttest

 b3dbab3810fc: Pull complete
 a9539b34a6ab: Pull complete
 Digest: sha256:d149ab53f8718e987c3a3024bb8aa0e2caadf6c0328f1d9d850b2a2a67f2819a
 Status: Downloaded newer image for docker/trusttest:latest
</code></pre></div>    </div>
  </li>
  <li>
    <p>Tag it to be pushed to our sandbox registry:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> / # docker tag docker/trusttest sandboxregistry:5000/test/trusttest:latest
</code></pre></div>    </div>
  </li>
  <li>
    <p>Enable content trust.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> / # export DOCKER_CONTENT_TRUST=1
</code></pre></div>    </div>
  </li>
  <li>
    <p>Identify the trust server.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> / # export DOCKER_CONTENT_TRUST_SERVER=https://notaryserver:4443
</code></pre></div>    </div>

    <p>This step is only necessary because the sandbox is using its own server.
 Normally, if you are using the Docker Public Hub this step isn’t necessary.</p>
  </li>
  <li>
    <p>Pull the test image.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> / # docker pull sandboxregistry:5000/test/trusttest
 Using default tag: latest
 Error: remote trust data does not exist for sandboxregistry:5000/test/trusttest: notaryserver:4443 does not have trust data for sandboxregistry:5000/test/trusttest
</code></pre></div>    </div>

    <p>You see an error, because this content doesn’t exist on the <code class="highlighter-rouge">notaryserver</code> yet.</p>
  </li>
  <li>
    <p>Push and sign the trusted image.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> / # docker push sandboxregistry:5000/test/trusttest:latest
 The push refers to a repository [sandboxregistry:5000/test/trusttest]
 5f70bf18a086: Pushed
 c22f7bc058a9: Pushed
 latest: digest: sha256:ebf59c538accdf160ef435f1a19938ab8c0d6bd96aef8d4ddd1b379edf15a926 size: 734
 Signing and pushing trust metadata
 You are about to create a new root signing key passphrase. This passphrase
 will be used to protect the most sensitive key in your signing system. Please
 choose a long, complex passphrase and be careful to keep the password and the
 key file itself secure and backed up. It is highly recommended that you use a
 password manager to generate the passphrase and keep it safe. There will be no
 way to recover this key. You can find the key in your config directory.
 Enter passphrase for new root key with ID 27ec255:
 Repeat passphrase for new root key with ID 27ec255:
 Enter passphrase for new repository key with ID 58233f9 (sandboxregistry:5000/test/trusttest):
 Repeat passphrase for new repository key with ID 58233f9 (sandboxregistry:5000/test/trusttest):
 Finished initializing "sandboxregistry:5000/test/trusttest"
 Successfully signed "sandboxregistry:5000/test/trusttest":latest
</code></pre></div>    </div>

    <p>Because you are pushing this repository for the first time, Docker creates
 new root and repository keys and asks you for passphrases with which to
 encrypt them. If you push again after this, it only asks you for repository
 passphrase so it can decrypt the key and sign again.</p>
  </li>
  <li>
    <p>Try pulling the image you just pushed:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> / # docker pull sandboxregistry:5000/test/trusttest
 Using default tag: latest
 Pull (1 of 1): sandboxregistry:5000/test/trusttest:latest@sha256:ebf59c538accdf160ef435f1a19938ab8c0d6bd96aef8d4ddd1b379edf15a926
 sha256:ebf59c538accdf160ef435f1a19938ab8c0d6bd96aef8d4ddd1b379edf15a926: Pulling from test/trusttest
 Digest: sha256:ebf59c538accdf160ef435f1a19938ab8c0d6bd96aef8d4ddd1b379edf15a926
 Status: Downloaded newer image for sandboxregistry:5000/test/trusttest@sha256:ebf59c538accdf160ef435f1a19938ab8c0d6bd96aef8d4ddd1b379edf15a926
 Tagging sandboxregistry:5000/test/trusttest@sha256:ebf59c538accdf160ef435f1a19938ab8c0d6bd96aef8d4ddd1b379edf15a926 as sandboxregistry:5000/test/trusttest:latest
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="test-with-malicious-images">Test with malicious images</h3>

<p>What happens when data is corrupted and you try to pull it when trust is
enabled? In this section, you go into the <code class="highlighter-rouge">sandboxregistry</code> and tamper with some
data. Then, you try and pull it.</p>

<ol>
  <li>
    <p>Leave the <code class="highlighter-rouge">trustsandbox</code> shell and container running.</p>
  </li>
  <li>
    <p>Open a new interactive terminal from your host, and obtain a shell into the
<code class="highlighter-rouge">sandboxregistry</code> container.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker container exec -it sandboxregistry bash
root@65084fc6f047:/#
</code></pre></div>    </div>
  </li>
  <li>
    <p>List the layers for the <code class="highlighter-rouge">test/trusttest</code> image you pushed:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@65084fc6f047:/# <span class="nb">ls</span> <span class="nt">-l</span> /var/lib/registry/docker/registry/v2/repositories/test/trusttest/_layers/sha256
total 12
drwxr-xr-x 2 root root 4096 Jun 10 17:26 a3ed95caeb02ffe68cdd9fd84406680ae93d633cb16422d00e8a7c22955b46d4
drwxr-xr-x 2 root root 4096 Jun 10 17:26 aac0c133338db2b18ff054943cee3267fe50c75cdee969aed88b1992539ed042
drwxr-xr-x 2 root root 4096 Jun 10 17:26 cc7629d1331a7362b5e5126beb5bf15ca0bf67eb41eab994c719a45de53255cd
</code></pre></div>    </div>
  </li>
  <li>
    <p>Change into the registry storage for one of those layers (this is in a different directory):</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@65084fc6f047:/# cd /var/lib/registry/docker/registry/v2/blobs/sha256/aa/aac0c133338db2b18ff054943cee3267fe50c75cdee969aed88b1992539ed042
</code></pre></div>    </div>
  </li>
  <li>
    <p>Add malicious data to one of the <code class="highlighter-rouge">trusttest</code> layers:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@65084fc6f047:/# echo "Malicious data" &gt; data
</code></pre></div>    </div>
  </li>
  <li>
    <p>Go back to your <code class="highlighter-rouge">trustsandbox</code> terminal.</p>
  </li>
  <li>
    <p>List the <code class="highlighter-rouge">trusttest</code> image.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ # docker image ls | grep trusttest
REPOSITORY                            TAG                 IMAGE ID            CREATED             SIZE
docker/trusttest                      latest              cc7629d1331a        11 months ago       5.025 MB
sandboxregistry:5000/test/trusttest   latest              cc7629d1331a        11 months ago       5.025 MB
sandboxregistry:5000/test/trusttest   &lt;none&gt;              cc7629d1331a        11 months ago       5.025 MB
</code></pre></div>    </div>
  </li>
  <li>
    <p>Remove the <code class="highlighter-rouge">trusttest:latest</code> image from our local cache.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ # docker image rm -f cc7629d1331a
Untagged: docker/trusttest:latest
Untagged: sandboxregistry:5000/test/trusttest:latest
Untagged: sandboxregistry:5000/test/trusttest@sha256:ebf59c538accdf160ef435f1a19938ab8c0d6bd96aef8d4ddd1b379edf15a926
Deleted: sha256:cc7629d1331a7362b5e5126beb5bf15ca0bf67eb41eab994c719a45de53255cd
Deleted: sha256:2a1f6535dc6816ffadcdbe20590045e6cbf048d63fd4cc753a684c9bc01abeea
Deleted: sha256:c22f7bc058a9a8ffeb32989b5d3338787e73855bf224af7aa162823da015d44c
</code></pre></div>    </div>

    <p>Docker does not re-download images that it already has cached, but we want
Docker to attempt to download the tampered image from the registry and reject
it because it is invalid.</p>
  </li>
  <li>
    <p>Pull the image again. This downloads the image from the registry, because we don’t have it cached.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/ # docker pull sandboxregistry:5000/test/trusttest
Using default tag: latest
Pull (1 of 1): sandboxregistry:5000/test/trusttest:latest@sha256:35d5bc26fd358da8320c137784fe590d8fcf9417263ef261653e8e1c7f15672e
sha256:35d5bc26fd358da8320c137784fe590d8fcf9417263ef261653e8e1c7f15672e: Pulling from test/trusttest

aac0c133338d: Retrying in 5 seconds
a3ed95caeb02: Download complete
error pulling image configuration: unexpected EOF
</code></pre></div>    </div>

    <p>The pull did not complete because the trust system couldn’t verify the
  image.</p>
  </li>
</ol>

<h2 id="more-play-in-the-sandbox">More play in the sandbox</h2>

<p>Now, you have a full Docker content trust sandbox on your local system,
feel free to play with it and see how it behaves. If you find any security
issues with Docker, feel free to send us an email at <a href="mailto:security@docker.com">security@docker.com</a>.</p>

<h2 id="clean-up-your-sandbox">Clean up your sandbox</h2>

<p>When you are done, and want to clean up all the services you’ve started and any
anonymous volumes that have been created, just run the following command in the
directory where you’ve created your Docker Compose file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    $ docker-compose down -v
</code></pre></div></div>

							<!-- tags -->
							
							
							
							<span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=trust">trust</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=security">security</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=root">root</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=keys">keys</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=repository">repository</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=sandbox">sandbox</a></span>
							
							<!-- link corrections -->
              <script language="JavaScript">
							var x = document.links.length;
							var baseHref = document.getElementsByTagName('base')[0].href
							for (i = 0; i < x; i++) {
							  var munged = false;
							  var thisHREF = document.links[i].href;
							  var originalURL = "/engine/security/trust/trust_sandbox/";
							  if (thisHREF.indexOf(baseHref + "#") > -1) {
							    // hash fix
							    //console.log('BEFORE: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							    thisHREF = originalURL + thisHREF.replace(baseHref, "");
							    //console.log('AFTER: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							  }
							  if ((thisHREF.indexOf(window.location.hostname) > -1 || thisHREF.indexOf('http') == -1) && document.links[i].className.indexOf("nomunge") < 0) {
							    munged = true;
							    thisHREF = thisHREF.replace(".md", "/").replace("/index/", "/");
							    document.links[i].setAttribute('href', thisHREF);
							  }
							}
							</script>
							
						  <div id="ratings-div" style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
								<div id="pd_rating_holder_8453675"></div>
								<script type="text/javascript">
									PDRTJS_settings_8453675 = {
										"id": "8453675",
										"unique_id": "engine/security/trust/trust_sandbox.md",
										"title": "Play in a content trust sandbox",
										"permalink": "https://github.com/docker/docker.github.io/blob/master/engine/security/trust/trust_sandbox.md"
									};
									(function(d, c, j) {
										if (!document.getElementById(j)) {
											var pd = d.createElement(c),
												s;
											pd.id = j;
											pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
											s = document.getElementsByTagName(c)[0];
											s.parentNode.insertBefore(pd, s);
										}
									}(document, 'script', 'pd-rating-js'));
								</script>
							</div>
							
						</section>
					</main>
					<nav class="col-nav">
						<div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
						<div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

						</div>
					</nav>
					<div class="col-toc">
							<div class="sidebar hidden-xs hidden-sm">
							<div class="toc-nav">
								<div class="feedback-links">
									<ul>
										
										<li style="visibility: hidden"><a href="https://github.com/matsuand/docs.docker.jp/edit/v19.03.local/engine/security/trust/trust_sandbox.md"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
										<li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/issues/new?body=File: [engine/security/trust/trust_sandbox.md](https://matsuand.github.io/docs.docker.jp.onthefly/engine/security/trust/trust_sandbox/)"
															class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
										<li><a href="https://success.docker.com/support"><i class="fa fa-question" aria-hidden="true"></i> サポート依頼</a></li>
										<!-- toggle mode -->
										<li>
											<div class="toggle-mode">
												<div class="icon">
													<i class="fa fa-sun-o" aria-hidden="true"></i>
												</div>
												<div class="toggle-switch">
													<label class="switch">
														<input type="checkbox" id="switch-style">
														<div class="slider round"></div>
												</label>
												</div>
												<div class="icon">
													<i class="fa fa-moon-o" aria-hidden="true"></i>
												</div>
											</div>
										</li>
									</ul>
								</div>
								   
									<div id="side-toc-title">本ページ内</div>
									
<ul id="my_toc" class="inline_toc">
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/trust_sandbox.md#prerequisites" class="nomunge">Prerequisites</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/trust_sandbox.md#what-is-in-the-sandbox" class="nomunge">What is in the sandbox?</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/trust_sandbox.md#build-the-sandbox" class="nomunge">Build the sandbox</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/trust_sandbox.md#play-in-the-sandbox" class="nomunge">Play in the sandbox</a>
    <ul>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/trust_sandbox.md#test-some-trust-operations" class="nomunge">Test some trust operations</a></li>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/trust_sandbox.md#test-with-malicious-images" class="nomunge">Test with malicious images</a></li>
    </ul>
  </li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/trust_sandbox.md#more-play-in-the-sandbox" class="nomunge">More play in the sandbox</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/trust_sandbox.md#clean-up-your-sandbox" class="nomunge">Clean up your sandbox</a></li>
</ul>


								</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	
	<footer class="footer">
		  
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/what-docker">What is Docker</a></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners/partner-program">Partners</a></li>
                        <li class="break"><a href="https://www.docker.com/industry-government">For Government</a></li>
                        <li><a href="https://www.docker.com/company">About Docker</a></li>
                        <li><a href="https://www.docker.com/company/management">Management</a></li>
                        <li><a href="https://www.docker.com/company/news-and-press">Press &amp; News</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/products/overview">Product</a></li>
                        <li><a href="https://www.docker.com/pricing">Pricing</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community Edition</a></li>
                        <li class="break"><a href="https://www.docker.com/enterprise">Enterprise Edition </a></li>
                        <li><a href="https://www.docker.com/products/docker-datacenter">Docker Datacenter</a></li>
                        <li><a href="https://hub.docker.com/">Docker Hub</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/">Documentation</a></li>
                        <li><a href="https://www.docker.com/docker">Learn</a></li>
                        <li><a href="https://blog.docker.com" target="_blank">Blog</a></li>
                        <li><a href="https://engineering.docker.com" target="_blank">Engineering Blog</a></li>
                        <li><a href="https://training.docker.com/" target="_blank">Training</a></li>
                        <li><a href="https://success.docker.com/support">Support</a></li>
                        <li><a href="https://success.docker.com/kbase">Knowledge Base</a></li>
                        <li><a href="https://www.docker.com/products/resources">Resources</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/technologies/overview">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/events">Events</a></li>
                        <li><a href="https://forums.docker.com/" target="_blank">Forums</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                        <li><a href="https://www.docker.com/docker-community/scholarships">Scholarships</a></li>
                        <li><a href="https://blog.docker.com/curated/">Community News</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2019 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-reddit"><a href="http://www.reddit.com/r/docker">Reddit</a></li>
                    <li class="fa fa-slideshare"><a href="http://www.slideshare.net/docker">Slideshare</a></li>
                </ul>
            </div>
        </div>
    </div>

	</footer>
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/github.css">
	
	<!-- <script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/anchorlinks.js"></script> -->
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/menu.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/jquery.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
	<!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03';
	// In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
	var jekyllEnv = 'development';
	// If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
	if (jekyllEnv == 'development') {
		jekyllEnv = '';
	}
	var pageURL = jekyllEnv + '/engine/security/trust/trust_sandbox/';
	</script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/archive.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/metadata.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/glossary.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/collections_tocs.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/docs.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/toc.js"></script>
	<script language="javascript">
	jQuery(document).ready(function(){
				hookupTOCEvents();
			});
	</script>
</body>

</html>
