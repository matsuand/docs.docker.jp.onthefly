<!-- Page generated 2020-05-27 13:03:45 +0900 -->
<!-- Logic for 'edit this button'


    

    

    

    

    

    

    

    

-->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <style type="text/css">
      @charset "UTF-8";
      [ng\:cloak],
      [ng-cloak],
      [data-ng-cloak],
      [x-ng-cloak],
      .ng-cloak,
      .x-ng-cloak,
      .ng-hide:not(.ng-hide-animate) {
          display: none !important;
      }

      ng\:form {
          display: block;
      }
  </style>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WL2QLG5');</script>

  
  <!-- favicon -->
  <link rel="icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta name="msapplication-TileImage" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico">
  <link rel="apple-touch-icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta property="og:image" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
  <!-- metadata -->
  <meta property="og:type" content="website"/>
  <meta property="og:updated_time" itemprop="dateUpdated" content="2020-05-27T13:03:45+09:00"/>
  <meta property="og:image" itemprop="image primaryImageOfPage" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:card" content="summary"/>
  <meta name="twitter:domain" content="docs.docker.com"/>
  <meta name="twitter:site" content="@docker_docs"/>
  <meta name="twitter:url" content="https://twitter.com/docker_docs"/>
  <meta name="twitter:title" itemprop="title name" content="docker service create"/>
  <meta name="twitter:description" property="og:description" itemprop="description" content="説明 Create a new service API 1.24+  このコマンドを利用するには、クライアントとデーモンの API はともに、最低でも 1.24 である必要があります。 クライアント上において docker version コマンドを実行して、クライアントとデーモンの API バージョンを確認してください。 Swarm This command works with the Swarm orchestrator. 利用方法 docker service create..." />
  <meta name="twitter:image:src" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:image:alt" content="Docker Documentation"/>
  <meta property="article:published_time" itemprop="datePublished" content="2020-05-27T13:03:45+09:00"/>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="docker, docker open source, docker platform, distributed applications, microservices, containers, docker containers, docker software, docker virtualization">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/font-awesome.min.css">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/bootstrap.min.css">
  <link id="pygments" rel="stylesheet" href="/docs.docker.jp.onthefly/css/pygments/perldoc.css">
  <link id="pagestyle" rel="stylesheet" href="/docs.docker.jp.onthefly/css/style.css">

  <!-- Go get "Open Sans" font from Google -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <!-- SEO stuff -->
  <title>docker service create | Docker Documentation</title>
  <meta property="og:title" content="docker service create" />
  <meta property="og:locale" content="ja_JP" />
  <meta name="description" content="" />
  <meta property="og:description" content="" />
  <link rel="canonical" href="/engine/reference/commandline/service_create/" />
  <meta property="og:url" content="https://docs.docker.com/engine/reference/commandline/service_create/" />
  <meta property="og:site_name" content="Docker ドキュメント" />
  <script type="application/ld+json">{"@context":"http://schema.org","@type":"WebPage","headline":"docker service create","description":"","url":"https://docs.docker.com/engine/reference/commandline/service_create/"}</script>
  <!-- END SEO STUFF -->
  
  <script>
  // Default to assuming this is an archive and hiding some stuff
  // See js/archive.js and js/docs.js for logic relating to this
  var isArchive = true;
  var dockerVersion = 'v19.03';
  </script>
</head>


    <body ng-app="Docker" ng-controller="DockerController" class="colums">
    <header>
        <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/docs.docker.jp.onthefly/"><img class="logo" src="/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="https://matsuand.github.io/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v19.03 (最新)     <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.09/">Docker v18.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

    </header>
    <div class="wrapper right-open">
        <div class="container-fluid">
            <div class="row">
                <div class="col-body">
                    <main class="col-content content">
                        <section class="section">
                            
                            
                            <h1>docker service create</h1> 
                            
                            
                            
                            <!--
This page is automatically generated from Docker's source code. If you want to
suggest a change to the text that appears here, open a ticket or pull request
in the source repository on GitHub:

https://github.com/docker/cli
-->
<!-- Make sure atom is using hard tabs -->

<h2 id="description">説明</h2>

<p>Create a new service</p>

<p><a href="/engine/api/v1.24/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" data-placement="right" title="Open the 1.24 API reference (in a new window)">API 1.24+</span></a> 
このコマンドを利用するには、クライアントとデーモンの API はともに、最低でも
<a href="/engine/api/v1.24/" target="_blank" class="_">1.24</a>
である必要があります。
クライアント上において <code class="highlighter-rouge">docker version</code> コマンドを実行して、クライアントとデーモンの API バージョンを確認してください。</p>

<p><span class="badge badge-info" data-toggle="tooltip" data-placement="right" title="This command works with the Swarm orchestrator.">Swarm</span> This command works with the Swarm orchestrator.</p>

<h2 id="usage">利用方法</h2>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="go">docker service create [OPTIONS] IMAGE [COMMAND] [ARG...]
</span></code></pre></div></div>

<h2 id="extended-description">Extended description</h2>

<p>Creates a service as described by the specified parameters.</p>

<blockquote>
  <p><strong>Note</strong></p>

  <p>This is a cluster management command, and must be executed on a swarm
manager node. To learn about managers and workers, refer to the
<a href="https://docs.docker.com/engine/swarm/">Swarm mode section</a> in the
documentation.</p>
</blockquote>

<p>For example uses of this command, refer to the <a href="#examples">examples section</a> below.</p>

<h2 id="options">オプション</h2>

<table>
<thead>
  <tr>
    <td>名前／省略形</td>
    <td>デフォルト</td>
    <td>説明</td>
  </tr>
</thead>
<tbody>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--config</code></td>
    <td></td>
    <td><a href="/engine/api/v1.30/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.30+</span></a><br />Specify configurations to expose to the service</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--constraint</code></td>
    <td></td>
    <td>Placement constraints</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--container-label</code></td>
    <td></td>
    <td>Container labels</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--credential-spec</code></td>
    <td></td>
    <td><a href="/engine/api/v1.29/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.29+</span></a><br />Credential spec for managed service account (Windows only)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--detach , -d</code></td>
    <td></td>
    <td><a href="/engine/api/v1.29/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.29+</span></a><br />Exit immediately instead of waiting for the service to converge</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--dns</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Set custom DNS servers</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--dns-option</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Set DNS options</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--dns-search</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Set custom DNS search domains</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--endpoint-mode</code></td>
    <td><code class="highlighter-rouge">vip</code></td>
    <td>Endpoint mode (vip or dnsrr)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--entrypoint</code></td>
    <td></td>
    <td>Overwrite the default ENTRYPOINT of the image</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--env , -e</code></td>
    <td></td>
    <td>Set environment variables</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--env-file</code></td>
    <td></td>
    <td>Read in a file of environment variables</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--generic-resource</code></td>
    <td></td>
    <td>User defined resources</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--group</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Set one or more supplementary user groups for the container</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--health-cmd</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Command to run to check health</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--health-interval</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Time between running the check (ms|s|m|h)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--health-retries</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Consecutive failures needed to report unhealthy</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--health-start-period</code></td>
    <td></td>
    <td><a href="/engine/api/v1.29/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.29+</span></a><br />Start period for the container to initialize before counting retries towards unstable (ms|s|m|h)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--health-timeout</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Maximum time to allow one check to run (ms|s|m|h)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--host</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Set one or more custom host-to-IP mappings (host:ip)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--hostname</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Container hostname</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--init</code></td>
    <td></td>
    <td><a href="/engine/api/v1.37/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.37+</span></a><br />Use an init inside each service container to forward signals and reap processes</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--isolation</code></td>
    <td></td>
    <td><a href="/engine/api/v1.35/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.35+</span></a><br />Service container isolation mode</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--label , -l</code></td>
    <td></td>
    <td>Service labels</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--limit-cpu</code></td>
    <td></td>
    <td>Limit CPUs</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--limit-memory</code></td>
    <td></td>
    <td>Limit Memory</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--log-driver</code></td>
    <td></td>
    <td>Logging driver for service</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--log-opt</code></td>
    <td></td>
    <td>Logging driver options</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--mode</code></td>
    <td><code class="highlighter-rouge">replicated</code></td>
    <td>Service mode (replicated or global)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--mount</code></td>
    <td></td>
    <td>Attach a filesystem mount to the service</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--name</code></td>
    <td></td>
    <td>Service name</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--network</code></td>
    <td></td>
    <td>Network attachments</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--no-healthcheck</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Disable any container-specified HEALTHCHECK</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--no-resolve-image</code></td>
    <td></td>
    <td><a href="/engine/api/v1.30/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.30+</span></a><br />Do not query the registry to resolve image digest and supported platforms</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--placement-pref</code></td>
    <td></td>
    <td><a href="/engine/api/v1.28/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.28+</span></a><br />Add a placement preference</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--publish , -p</code></td>
    <td></td>
    <td>Publish a port as a node port</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--quiet , -q</code></td>
    <td></td>
    <td>Suppress progress output</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--read-only</code></td>
    <td></td>
    <td><a href="/engine/api/v1.28/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.28+</span></a><br />Mount the container’s root filesystem as read only</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--replicas</code></td>
    <td></td>
    <td>Number of tasks</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--replicas-max-per-node</code></td>
    <td></td>
    <td><a href="/engine/api/v1.40/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.40+</span></a><br />Maximum number of tasks per node (default 0 = unlimited)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--reserve-cpu</code></td>
    <td></td>
    <td>Reserve CPUs</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--reserve-memory</code></td>
    <td></td>
    <td>Reserve Memory</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--restart-condition</code></td>
    <td></td>
    <td>Restart when condition is met (“none”|”on-failure”|”any”) (default “any”)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--restart-delay</code></td>
    <td></td>
    <td>Delay between restart attempts (ns|us|ms|s|m|h) (default 5s)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--restart-max-attempts</code></td>
    <td></td>
    <td>Maximum number of restarts before giving up</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--restart-window</code></td>
    <td></td>
    <td>Window used to evaluate the restart policy (ns|us|ms|s|m|h)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--rollback-delay</code></td>
    <td></td>
    <td><a href="/engine/api/v1.28/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.28+</span></a><br />Delay between task rollbacks (ns|us|ms|s|m|h) (default 0s)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--rollback-failure-action</code></td>
    <td></td>
    <td><a href="/engine/api/v1.28/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.28+</span></a><br />Action on rollback failure (“pause”|”continue”) (default “pause”)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--rollback-max-failure-ratio</code></td>
    <td></td>
    <td><a href="/engine/api/v1.28/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.28+</span></a><br />Failure rate to tolerate during a rollback (default 0)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--rollback-monitor</code></td>
    <td></td>
    <td><a href="/engine/api/v1.28/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.28+</span></a><br />Duration after each task rollback to monitor for failure (ns|us|ms|s|m|h) (default 5s)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--rollback-order</code></td>
    <td></td>
    <td><a href="/engine/api/v1.29/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.29+</span></a><br />Rollback order (“start-first”|”stop-first”) (default “stop-first”)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--rollback-parallelism</code></td>
    <td><code class="highlighter-rouge">1</code></td>
    <td><a href="/engine/api/v1.28/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.28+</span></a><br />Maximum number of tasks rolled back simultaneously (0 to roll back all at once)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--secret</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Specify secrets to expose to the service</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--stop-grace-period</code></td>
    <td></td>
    <td>Time to wait before force killing a container (ns|us|ms|s|m|h) (default 10s)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--stop-signal</code></td>
    <td></td>
    <td><a href="/engine/api/v1.28/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.28+</span></a><br />Signal to stop the container</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--sysctl</code></td>
    <td></td>
    <td><a href="/engine/api/v1.40/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.40+</span></a><br />Sysctl options</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--tty , -t</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Allocate a pseudo-TTY</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--update-delay</code></td>
    <td></td>
    <td>Delay between updates (ns|us|ms|s|m|h) (default 0s)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--update-failure-action</code></td>
    <td></td>
    <td>Action on update failure (“pause”|”continue”|”rollback”) (default “pause”)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--update-max-failure-ratio</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Failure rate to tolerate during an update (default 0)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--update-monitor</code></td>
    <td></td>
    <td><a href="/engine/api/v1.25/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.25+</span></a><br />Duration after each task update to monitor for failure (ns|us|ms|s|m|h) (default 5s)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--update-order</code></td>
    <td></td>
    <td><a href="/engine/api/v1.29/" target="_blank" class="_"><span class="badge badge-info" data-toggle="tooltip" ttitle="Open the 1.24 API reference (in a new window)">API 1.29+</span></a><br />Update order (“start-first”|”stop-first”) (default “stop-first”)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--update-parallelism</code></td>
    <td><code class="highlighter-rouge">1</code></td>
    <td>Maximum number of tasks updated simultaneously (0 to update all at once)</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--user , -u</code></td>
    <td></td>
    <td>Username or UID (format: &lt;name|uid&gt;[:&lt;group|gid&gt;])</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--with-registry-auth</code></td>
    <td></td>
    <td>Send registry authentication details to swarm agents</td>
  </tr>

  
  
  
  
  
  
  
  
  <tr>
    <td><code class="highlighter-rouge">--workdir , -w</code></td>
    <td></td>
    <td>Working directory inside the container</td>
  </tr>
 <!-- end for option -->
</tbody>
</table>
<p><!-- end if options --></p>

<h2 id="examples">Examples</h2>

<h3 id="create-a-service">Create a service</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="nt">--name</span> redis redis:3.0.6

dmu1ept4cxcfe8k8lhtux3ro3

<span class="nv">$ </span>docker service create <span class="nt">--mode</span> global <span class="nt">--name</span> redis2 redis:3.0.6

a8q9dasaafudfs8q8w32udass

<span class="nv">$ </span>docker service <span class="nb">ls

</span>ID            NAME    MODE        REPLICAS  IMAGE
dmu1ept4cxcf  redis   replicated  1/1       redis:3.0.6
a8q9dasaafud  redis2  global      1/1       redis:3.0.6
</code></pre></div></div>

<h4 id="create-a-service-using-an-image-on-a-private-registry">Create a service using an image on a private registry</h4>

<p>If your image is available on a private registry which requires login, use the
<code class="highlighter-rouge">--with-registry-auth</code> flag with <code class="highlighter-rouge">docker service create</code>, after logging in. If
your image is stored on <code class="highlighter-rouge">registry.example.com</code>, which is a private registry, use
a command like the following:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker login registry.example.com

<span class="nv">$ </span>docker service  create <span class="se">\</span>
  <span class="nt">--with-registry-auth</span> <span class="se">\</span>
  <span class="nt">--name</span> my_service <span class="se">\</span>
  registry.example.com/acme/my_image:latest
</code></pre></div></div>

<p>This passes the login token from your local client to the swarm nodes where the
service is deployed, using the encrypted WAL logs. With this information, the
nodes are able to log into the registry and pull the image.</p>

<h3 id="create-a-service-with-5-replica-tasks---replicas">Create a service with 5 replica tasks (--replicas)</h3>

<p>Use the <code class="highlighter-rouge">--replicas</code> flag to set the number of replica tasks for a replicated
service. The following command creates a <code class="highlighter-rouge">redis</code> service with <code class="highlighter-rouge">5</code> replica tasks:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="nt">--name</span> redis <span class="nt">--replicas</span><span class="o">=</span>5 redis:3.0.6

4cdgfyky7ozwh3htjfw0d12qv
</code></pre></div></div>

<p>The above command sets the <em>desired</em> number of tasks for the service. Even
though the command returns immediately, actual scaling of the service may take
some time. The <code class="highlighter-rouge">REPLICAS</code> column shows both the <em>actual</em> and <em>desired</em> number
of replica tasks for the service.</p>

<p>In the following example the desired state is  <code class="highlighter-rouge">5</code> replicas, but the current
number of <code class="highlighter-rouge">RUNNING</code> tasks is <code class="highlighter-rouge">3</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service <span class="nb">ls

</span>ID            NAME   MODE        REPLICAS  IMAGE
4cdgfyky7ozw  redis  replicated  3/5       redis:3.0.7
</code></pre></div></div>

<p>Once all the tasks are created and <code class="highlighter-rouge">RUNNING</code>, the actual number of tasks is
equal to the desired number:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service <span class="nb">ls

</span>ID            NAME   MODE        REPLICAS  IMAGE
4cdgfyky7ozw  redis  replicated  5/5       redis:3.0.7
</code></pre></div></div>

<h3 id="create-a-service-with-secrets">Create a service with secrets</h3>

<p>Use the <code class="highlighter-rouge">--secret</code> flag to give a container access to a
<a href="/engine/reference/commandline/secret_create/">secret</a>.</p>

<p>Create a service specifying a secret:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="nt">--name</span> redis <span class="nt">--secret</span> secret.json redis:3.0.6

4cdgfyky7ozwh3htjfw0d12qv
</code></pre></div></div>

<p>Create a service specifying the secret, target, user/group ID, and mode:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="nt">--name</span> redis <span class="se">\</span>
    <span class="nt">--secret</span> <span class="nb">source</span><span class="o">=</span>ssh-key,target<span class="o">=</span>ssh <span class="se">\</span>
    <span class="nt">--secret</span> <span class="nb">source</span><span class="o">=</span>app-key,target<span class="o">=</span>app,uid<span class="o">=</span>1000,gid<span class="o">=</span>1001,mode<span class="o">=</span>0400 <span class="se">\</span>
    redis:3.0.6

4cdgfyky7ozwh3htjfw0d12qv
</code></pre></div></div>

<p>To grant a service access to multiple secrets, use multiple <code class="highlighter-rouge">--secret</code> flags.</p>

<p>Secrets are located in <code class="highlighter-rouge">/run/secrets</code> in the container if no target is specified.
If no target is specified, the name of the secret is used as the in memory file
in the container. If a target is specified, that is used as the filename. In the
example above, two files are created: <code class="highlighter-rouge">/run/secrets/ssh</code> and
<code class="highlighter-rouge">/run/secrets/app</code> for each of the secret targets specified.</p>

<h3 id="create-a-service-with-configs">Create a service with configs</h3>

<p>Use the <code class="highlighter-rouge">--config</code> flag to give a container access to a
<a href="/engine/reference/commandline/config_create/">config</a>.</p>

<p>Create a service with a config. The config will be mounted into <code class="highlighter-rouge">redis-config</code>,
be owned by the user who runs the command inside the container (often <code class="highlighter-rouge">root</code>),
and have file mode <code class="highlighter-rouge">0444</code> or world-readable. You can specify the <code class="highlighter-rouge">uid</code> and <code class="highlighter-rouge">gid</code>
as numerical IDs or names. When using names, the provided group/user names must
pre-exist in the container. The <code class="highlighter-rouge">mode</code> is specified as a 4-number sequence such
as <code class="highlighter-rouge">0755</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="nt">--name</span><span class="o">=</span>redis <span class="nt">--config</span> redis-conf redis:3.0.6
</code></pre></div></div>

<p>Create a service with a config and specify the target location and file mode:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="nt">--name</span> redis <span class="se">\</span>
  <span class="nt">--config</span> <span class="nb">source</span><span class="o">=</span>redis-conf,target<span class="o">=</span>/etc/redis/redis.conf,mode<span class="o">=</span>0400 redis:3.0.6
</code></pre></div></div>

<p>To grant a service access to multiple configs, use multiple <code class="highlighter-rouge">--config</code> flags.</p>

<p>Configs are located in <code class="highlighter-rouge">/</code> in the container if no target is specified. If no
target is specified, the name of the config is used as the name of the file in
the container. If a target is specified, that is used as the filename.</p>

<h3 id="create-a-service-with-a-rolling-update-policy">Create a service with a rolling update policy</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
  <span class="nt">--replicas</span> 10 <span class="se">\</span>
  <span class="nt">--name</span> redis <span class="se">\</span>
  <span class="nt">--update-delay</span> 10s <span class="se">\</span>
  <span class="nt">--update-parallelism</span> 2 <span class="se">\</span>
  redis:3.0.6
</code></pre></div></div>

<p>When you run a <a href="/engine/reference/commandline/service_update/">service update</a>, the scheduler updates a
maximum of 2 tasks at a time, with <code class="highlighter-rouge">10s</code> between updates. For more information,
refer to the <a href="https://docs.docker.com/engine/swarm/swarm-tutorial/rolling-update/">rolling updates
tutorial</a>.</p>

<h3 id="set-environment-variables--e---env">Set environment variables (-e, --env)</h3>

<p>This sets an environment variable for all tasks in a service. For example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
  <span class="nt">--name</span> redis_2 <span class="se">\</span>
  <span class="nt">--replicas</span> 5 <span class="se">\</span>
  <span class="nt">--env</span> <span class="nv">MYVAR</span><span class="o">=</span>foo <span class="se">\</span>
  redis:3.0.6
</code></pre></div></div>

<p>To specify multiple environment variables, specify multiple <code class="highlighter-rouge">--env</code> flags, each
with a separate key-value pair.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
  <span class="nt">--name</span> redis_2 <span class="se">\</span>
  <span class="nt">--replicas</span> 5 <span class="se">\</span>
  <span class="nt">--env</span> <span class="nv">MYVAR</span><span class="o">=</span>foo <span class="se">\</span>
  <span class="nt">--env</span> <span class="nv">MYVAR2</span><span class="o">=</span>bar <span class="se">\</span>
  redis:3.0.6
</code></pre></div></div>

<h3 id="create-a-service-with-specific-hostname---hostname">Create a service with specific hostname (--hostname)</h3>

<p>This option sets the docker service containers hostname to a specific string.
For example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="nt">--name</span> redis <span class="nt">--hostname</span> myredis redis:3.0.6
</code></pre></div></div>

<h3 id="set-metadata-on-a-service--l---label">Set metadata on a service (-l, --label)</h3>

<p>A label is a <code class="highlighter-rouge">key=value</code> pair that applies metadata to a service. To label a
service with two labels:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
  <span class="nt">--name</span> redis_2 <span class="se">\</span>
  <span class="nt">--label</span> com.example.foo<span class="o">=</span><span class="s2">"bar"</span>
  <span class="nt">--label</span> <span class="nv">bar</span><span class="o">=</span>baz <span class="se">\</span>
  redis:3.0.6
</code></pre></div></div>

<p>For more information about labels, refer to <a href="https://docs.docker.com/config/labels-custom-metadata/">apply custom
metadata</a>.</p>

<h3 id="add-bind-mounts-volumes-or-memory-filesystems">Add bind mounts, volumes or memory filesystems</h3>

<p>Docker supports three different kinds of mounts, which allow containers to read
from or write to files or directories, either on the host operating system, or
on memory filesystems. These types are <em>data volumes</em> (often referred to simply
as volumes), <em>bind mounts</em>, <em>tmpfs</em>, and <em>named pipes</em>.</p>

<p>A <strong>bind mount</strong> makes a file or directory on the host available to the
container it is mounted within. A bind mount may be either read-only or
read-write. For example, a container might share its host’s DNS information by
means of a bind mount of the host’s <code class="highlighter-rouge">/etc/resolv.conf</code> or a container might
write logs to its host’s <code class="highlighter-rouge">/var/log/myContainerLogs</code> directory. If you use
bind mounts and your host and containers have different notions of permissions,
access controls, or other such details, you will run into portability issues.</p>

<p>A <strong>named volume</strong> is a mechanism for decoupling persistent data needed by your
container from the image used to create the container and from the host machine.
Named volumes are created and managed by Docker, and a named volume persists
even when no container is currently using it. Data in named volumes can be
shared between a container and the host machine, as well as between multiple
containers. Docker uses a <em>volume driver</em> to create, manage, and mount volumes.
You can back up or restore volumes using Docker commands.</p>

<p>A <strong>tmpfs</strong> mounts a tmpfs inside a container for volatile data.</p>

<p>A <strong>npipe</strong> mounts a named pipe from the host into the container.</p>

<p>Consider a situation where your image starts a lightweight web server. You could
use that image as a base image, copy in your website’s HTML files, and package
that into another image. Each time your website changed, you’d need to update
the new image and redeploy all of the containers serving your website. A better
solution is to store the website in a named volume which is attached to each of
your web server containers when they start. To update the website, you just
update the named volume.</p>

<p>For more information about named volumes, see
<a href="https://docs.docker.com/storage/volumes/">Data Volumes</a>.</p>

<p>The following table describes options which apply to both bind mounts and named
volumes in a service:</p>

<table>
  <tr>
    <th>Option</th>
    <th>Required</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><b>type</b></td>
    <td></td>
    <td>
      <p>The type of mount, can be either <tt>volume</tt>, <tt>bind</tt>, <tt>tmpfs</tt>, or <tt>npipe</tt>. Defaults to <tt>volume</tt> if no type is specified.</p>
      <ul>
        <li><tt>volume</tt>: mounts a <a href="https://docs.docker.com/engine/reference/commandline/volume_create/">managed volume</a>
        into the container.</li> <li><tt>bind</tt>:
        bind-mounts a directory or file from the host into the container.</li>
        <li><tt>tmpfs</tt>: mount a tmpfs in the container</li>
        <li><tt>npipe</tt>: mounts named pipe from the host into the container (Windows containers only).</li>
      </ul>
    </td>
  </tr>
  <tr>
    <td><b>src</b> or <b>source</b></td>
    <td>for <tt>type=bind</tt> and <tt>type=npipe</tt></td>
    <td>
      <ul>
        <li>
         <tt>type=volume</tt>: <tt>src</tt> is an optional way to specify the name of the volume (for example, <tt>src=my-volume</tt>).
          If the named volume does not exist, it is automatically created. If no <tt>src</tt> is specified, the volume is
          assigned a random name which is guaranteed to be unique on the host, but may not be unique cluster-wide.
          A randomly-named volume has the same lifecycle as its container and is destroyed when the <i>container</i>
          is destroyed (which is upon <tt>service update</tt>, or when scaling or re-balancing the service)
        </li>
        <li>
          <tt>type=bind</tt>: <tt>src</tt> is required, and specifies an absolute path to the file or directory to bind-mount
          (for example, <tt>src=/path/on/host/</tt>). An error is produced if the file or directory does not exist.
        </li>
        <li>
          <tt>type=tmpfs</tt>: <tt>src</tt> is not supported.
        </li>
      </ul>
    </td>
  </tr>
  <tr>
    <td><p><b>dst</b> or <b>destination</b> or <b>target</b></p></td>
    <td>yes</td>
    <td>
      <p>Mount path inside the container, for example <tt>/some/path/in/container/</tt>.
      If the path does not exist in the container's filesystem, the Engine creates
      a directory at the specified location before mounting the volume or bind mount.</p>
    </td>
  </tr>
  <tr>
    <td><p><b>readonly</b> or <b>ro</b></p></td>
    <td></td>
    <td>
      <p>The Engine mounts binds and volumes <tt>read-write</tt> unless <tt>readonly</tt> option
      is given when mounting the bind or volume. Note that setting <tt>readonly</tt> for a
      bind-mount does not make its submounts <tt>readonly</tt> on the current Linux implementation. See also <tt>bind-nonrecursive</tt>.</p>
      <ul>
        <li><tt>true</tt> or <tt>1</tt> or no value: Mounts the bind or volume read-only.</li>
        <li><tt>false</tt> or <tt>0</tt>: Mounts the bind or volume read-write.</li>
      </ul>
    </td>
  </tr>
</table>

<h4 id="options-for-bind-mounts">Options for Bind Mounts</h4>

<p>The following options can only be used for bind mounts (<code class="highlighter-rouge">type=bind</code>):</p>

<table>
  <tr>
    <th>Option</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><b>bind-propagation</b></td>
    <td>
      <p>See the <a href="#bind-propagation">bind propagation section</a>.</p>
    </td>
  </tr>
  <tr>
    <td><b>consistency</b></td>
    <td>
      <p>The consistency requirements for the mount; one of </p>
      <ul>
       <li><tt>default</tt>: Equivalent to <tt>consistent</tt>.</li>
       <li><tt>consistent</tt>: Full consistency.  The container runtime and the host maintain an identical view of the mount at all times.</li>
       <li><tt>cached</tt>: The host's view of the mount is authoritative.  There may be delays before updates made on the host are visible within a container.</li>
       <li><tt>delegated</tt>: The container runtime's view of the mount is authoritative.  There may be delays before updates made in a container are visible on the host.</li>
      </ul>
    </td>
  </tr>
  <tr>
    <td><b>bind-nonrecursive</b></td>
    <td>
      By default, submounts are recursively bind-mounted as well. However, this behavior can be confusing when a
      bind mount is configured with <tt>readonly</tt> option, because submounts are not mounted as read-only.
      Set <tt>bind-nonrecursive</tt> to disable recursive bind-mount.<br />
      <br />
      A value is optional:<br />
      <br />
      <ul>
        <li><tt>true</tt> or <tt>1</tt>: Disables recursive bind-mount.</li>
        <li><tt>false</tt> or <tt>0</tt>: Default if you do not provide a value. Enables recursive bind-mount.</li>
      </ul>
    </td>
  </tr>
</table>

<h5 id="bind-propagation">Bind propagation</h5>

<p>Bind propagation refers to whether or not mounts created within a given
bind mount or named volume can be propagated to replicas of that mount. Consider
a mount point <code class="highlighter-rouge">/mnt</code>, which is also mounted on <code class="highlighter-rouge">/tmp</code>. The propagation settings
control whether a mount on <code class="highlighter-rouge">/tmp/a</code> would also be available on <code class="highlighter-rouge">/mnt/a</code>. Each
propagation setting has a recursive counterpoint. In the case of recursion,
consider that <code class="highlighter-rouge">/tmp/a</code> is also mounted as <code class="highlighter-rouge">/foo</code>. The propagation settings
control whether <code class="highlighter-rouge">/mnt/a</code> and/or <code class="highlighter-rouge">/tmp/a</code> would exist.</p>

<p>The <code class="highlighter-rouge">bind-propagation</code> option defaults to <code class="highlighter-rouge">rprivate</code> for both bind mounts and
volume mounts, and is only configurable for bind mounts. In other words, named
volumes do not support bind propagation.</p>

<ul>
  <li><strong><code class="highlighter-rouge">shared</code></strong>: Sub-mounts of the original mount are exposed to replica mounts,
              and sub-mounts of replica mounts are also propagated to the
              original mount.</li>
  <li><strong><code class="highlighter-rouge">slave</code></strong>: similar to a shared mount, but only in one direction. If the
             original mount exposes a sub-mount, the replica mount can see it.
             However, if the replica mount exposes a sub-mount, the original
             mount cannot see it.</li>
  <li><strong><code class="highlighter-rouge">private</code></strong>: The mount is private. Sub-mounts within it are not exposed to
               replica mounts, and sub-mounts of replica mounts are not
               exposed to the original mount.</li>
  <li><strong><code class="highlighter-rouge">rshared</code></strong>: The same as shared, but the propagation also extends to and from
               mount points nested within any of the original or replica mount
               points.</li>
  <li><strong><code class="highlighter-rouge">rslave</code></strong>: The same as <code class="highlighter-rouge">slave</code>, but the propagation also extends to and from
               mount points nested within any of the original or replica mount
               points.</li>
  <li><strong><code class="highlighter-rouge">rprivate</code></strong>: The default. The same as <code class="highlighter-rouge">private</code>, meaning that no mount points
                anywhere within the original or replica mount points propagate
                in either direction.</li>
</ul>

<p>For more information about bind propagation, see the
<a href="https://www.kernel.org/doc/Documentation/filesystems/sharedsubtree.txt">Linux kernel documentation for shared subtree</a>.</p>

<h4 id="options-for-named-volumes">Options for named volumes</h4>

<p>The following options can only be used for named volumes (<code class="highlighter-rouge">type=volume</code>):</p>

<table>
  <tr>
    <th>Option</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><b>volume-driver</b></td>
    <td>
      <p>Name of the volume-driver plugin to use for the volume. Defaults to
      <tt>"local"</tt>, to use the local volume driver to create the volume if the
      volume does not exist.</p>
    </td>
  </tr>
  <tr>
    <td><b>volume-label</b></td>
    <td>
      One or more custom metadata ("labels") to apply to the volume upon
      creation. For example,
      <tt>volume-label=mylabel=hello-world,my-other-label=hello-mars</tt>. For more
      information about labels, refer to
      <a href="https://docs.docker.com/config/labels-custom-metadata/">apply custom metadata</a>.
    </td>
  </tr>
  <tr>
    <td><b>volume-nocopy</b></td>
    <td>
      By default, if you attach an empty volume to a container, and files or
      directories already existed at the mount-path in the container (<tt>dst</tt>),
      the Engine copies those files and directories into the volume, allowing
      the host to access them. Set <tt>volume-nocopy</tt> to disable copying files
      from the container's filesystem to the volume and mount the empty volume.<br />
      <br />
      A value is optional:<br />
      <br />
      <ul>
        <li><tt>true</tt> or <tt>1</tt>: Default if you do not provide a value. Disables copying.</li>
        <li><tt>false</tt> or <tt>0</tt>: Enables copying.</li>
      </ul>
    </td>
  </tr>
  <tr>
    <td><b>volume-opt</b></td>
    <td>
      Options specific to a given volume driver, which will be passed to the
      driver when creating the volume. Options are provided as a comma-separated
      list of key/value pairs, for example,
      <tt>volume-opt=some-option=some-value,volume-opt=some-other-option=some-other-value</tt>.
      For available options for a given driver, refer to that driver's
      documentation.
    </td>
  </tr>
</table>

<h4 id="options-for-tmpfs">Options for tmpfs</h4>

<p>The following options can only be used for tmpfs mounts (<code class="highlighter-rouge">type=tmpfs</code>);</p>

<table>
  <tr>
    <th>Option</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><b>tmpfs-size</b></td>
    <td>Size of the tmpfs mount in bytes. Unlimited by default in Linux.</td>
  </tr>
  <tr>
    <td><b>tmpfs-mode</b></td>
    <td>File mode of the tmpfs in octal. (e.g. <tt>"700"</tt> or <tt>"0700"</tt>.) Defaults to <tt>"1777"</tt> in Linux.</td>
  </tr>
</table>

<h4 id="differences-between---mount-and---volume">Differences between “--mount” and “--volume”</h4>

<p>The <code class="highlighter-rouge">--mount</code> flag supports most options that are supported by the <code class="highlighter-rouge">-v</code>
or <code class="highlighter-rouge">--volume</code> flag for <code class="highlighter-rouge">docker run</code>, with some important exceptions:</p>

<ul>
  <li>
    <p>The <code class="highlighter-rouge">--mount</code> flag allows you to specify a volume driver and volume driver
options <em>per volume</em>, without creating the volumes in advance. In contrast,
<code class="highlighter-rouge">docker run</code> allows you to specify a single volume driver which is shared
by all volumes, using the <code class="highlighter-rouge">--volume-driver</code> flag.</p>
  </li>
  <li>
    <p>The <code class="highlighter-rouge">--mount</code> flag allows you to specify custom metadata (“labels”) for a volume,
before the volume is created.</p>
  </li>
  <li>
    <p>When you use <code class="highlighter-rouge">--mount</code> with <code class="highlighter-rouge">type=bind</code>, the host-path must refer to an <em>existing</em>
path on the host. The path will not be created for you and the service will fail
with an error if the path does not exist.</p>
  </li>
  <li>
    <p>The <code class="highlighter-rouge">--mount</code> flag does not allow you to relabel a volume with <code class="highlighter-rouge">Z</code> or <code class="highlighter-rouge">z</code> flags,
which are used for <code class="highlighter-rouge">selinux</code> labeling.</p>
  </li>
</ul>

<h4 id="create-a-service-using-a-named-volume">Create a service using a named volume</h4>

<p>The following example creates a service that uses a named volume:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
  <span class="nt">--name</span> my-service <span class="se">\</span>
  <span class="nt">--replicas</span> 3 <span class="se">\</span>
  <span class="nt">--mount</span> <span class="nb">type</span><span class="o">=</span>volume,source<span class="o">=</span>my-volume,destination<span class="o">=</span>/path/in/container,volume-label<span class="o">=</span><span class="s2">"color=red"</span>,volume-label<span class="o">=</span><span class="s2">"shape=round"</span> <span class="se">\</span>
  nginx:alpine
</code></pre></div></div>

<p>For each replica of the service, the engine requests a volume named “my-volume”
from the default (“local”) volume driver where the task is deployed. If the
volume does not exist, the engine creates a new volume and applies the “color”
and “shape” labels.</p>

<p>When the task is started, the volume is mounted on <code class="highlighter-rouge">/path/in/container/</code> inside
the container.</p>

<p>Be aware that the default (“local”) volume is a locally scoped volume driver.
This means that depending on where a task is deployed, either that task gets a
<em>new</em> volume named “my-volume”, or shares the same “my-volume” with other tasks
of the same service. Multiple containers writing to a single shared volume can
cause data corruption if the software running inside the container is not
designed to handle concurrent processes writing to the same location. Also take
into account that containers can be re-scheduled by the Swarm orchestrator and
be deployed on a different node.</p>

<h4 id="create-a-service-that-uses-an-anonymous-volume">Create a service that uses an anonymous volume</h4>

<p>The following command creates a service with three replicas with an anonymous
volume on <code class="highlighter-rouge">/path/in/container</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
  <span class="nt">--name</span> my-service <span class="se">\</span>
  <span class="nt">--replicas</span> 3 <span class="se">\</span>
  <span class="nt">--mount</span> <span class="nb">type</span><span class="o">=</span>volume,destination<span class="o">=</span>/path/in/container <span class="se">\</span>
  nginx:alpine
</code></pre></div></div>

<p>In this example, no name (<code class="highlighter-rouge">source</code>) is specified for the volume, so a new volume
is created for each task. This guarantees that each task gets its own volume,
and volumes are not shared between tasks. Anonymous volumes are removed after
the task using them is complete.</p>

<h4 id="create-a-service-that-uses-a-bind-mounted-host-directory">Create a service that uses a bind-mounted host directory</h4>

<p>The following example bind-mounts a host directory at <code class="highlighter-rouge">/path/in/container</code> in
the containers backing the service:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
  <span class="nt">--name</span> my-service <span class="se">\</span>
  <span class="nt">--mount</span> <span class="nb">type</span><span class="o">=</span><span class="nb">bind</span>,source<span class="o">=</span>/path/on/host,destination<span class="o">=</span>/path/in/container <span class="se">\</span>
  nginx:alpine
</code></pre></div></div>

<h3 id="set-service-mode---mode">Set service mode (--mode)</h3>

<p>The service mode determines whether this is a <em>replicated</em> service or a <em>global</em>
service. A replicated service runs as many tasks as specified, while a global
service runs on each active node in the swarm.</p>

<p>The following command creates a global service:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
 <span class="nt">--name</span> redis_2 <span class="se">\</span>
 <span class="nt">--mode</span> global <span class="se">\</span>
 redis:3.0.6
</code></pre></div></div>

<h3 id="specify-service-constraints---constraint">Specify service constraints (--constraint)</h3>

<p>You can limit the set of nodes where a task can be scheduled by defining
constraint expressions. Constraint expressions can either use a <em>match</em> (<code class="highlighter-rouge">==</code>)
or <em>exclude</em> (<code class="highlighter-rouge">!=</code>) rule. Multiple constraints find nodes that satisfy every
expression (AND match). Constraints can match node or Docker Engine labels as
follows:</p>

<table>
  <thead>
    <tr>
      <th>node attribute</th>
      <th>matches</th>
      <th>example</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">node.id</code></td>
      <td>Node ID</td>
      <td><code class="highlighter-rouge">node.id==2ivku8v2gvtg4</code></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">node.hostname</code></td>
      <td>Node hostname</td>
      <td><code class="highlighter-rouge">node.hostname!=node-2</code></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">node.role</code></td>
      <td>Node role (<code class="highlighter-rouge">manager</code>/<code class="highlighter-rouge">worker</code>)</td>
      <td><code class="highlighter-rouge">node.role==manager</code></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">node.platform.os</code></td>
      <td>Node operating system</td>
      <td><code class="highlighter-rouge">node.platform.os==windows</code></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">node.platform.arch</code></td>
      <td>Node architecture</td>
      <td><code class="highlighter-rouge">node.platform.arch==x86_64</code></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">node.labels</code></td>
      <td>User-defined node labels</td>
      <td><code class="highlighter-rouge">node.labels.security==high</code></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">engine.labels</code></td>
      <td>Docker Engine’s labels</td>
      <td><code class="highlighter-rouge">engine.labels.operatingsystem==ubuntu-14.04</code></td>
    </tr>
  </tbody>
</table>

<p><code class="highlighter-rouge">engine.labels</code> apply to Docker Engine labels like operating system, drivers,
etc. Swarm administrators add <code class="highlighter-rouge">node.labels</code> for operational purposes by using
the <a href="/engine/reference/commandline/node_update/"><code class="highlighter-rouge">docker node update</code></a> command.</p>

<p>For example, the following limits tasks for the redis service to nodes where the
node type label equals queue:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
  <span class="nt">--name</span> redis_2 <span class="se">\</span>
  <span class="nt">--constraint</span> node.platform.os<span class="o">==</span>linux <span class="se">\</span>
  <span class="nt">--constraint</span> node.labels.type<span class="o">==</span>queue <span class="se">\</span>
  redis:3.0.6
</code></pre></div></div>

<p>If the service constraints exclude all nodes in the cluster, a message is printed
that no suitable node is found, but the scheduler will start a reconciliation
loop and deploy the service once a suitable node becomes available.</p>

<p>In the example below, no node satisfying the constraint was found, causing the
service to not reconcile with the desired state:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
  <span class="nt">--name</span> web <span class="se">\</span>
  <span class="nt">--constraint</span> node.labels.region<span class="o">==</span>east <span class="se">\</span>
  nginx:alpine

lx1wrhhpmbbu0wuk0ybws30bc
overall progress: 0 out of 1 tasks
1/1: no suitable node <span class="o">(</span>scheduling constraints not satisfied on 5 nodes<span class="o">)</span>

<span class="nv">$ </span>docker service <span class="nb">ls
</span>ID                  NAME     MODE         REPLICAS   IMAGE               PORTS
b6lww17hrr4e        web      replicated   0/1        nginx:alpine
</code></pre></div></div>

<p>After adding the <code class="highlighter-rouge">region=east</code> label to a node in the cluster, the service
reconciles, and the desired number of replicas are deployed:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker node update <span class="nt">--label-add</span> <span class="nv">region</span><span class="o">=</span>east yswe2dm4c5fdgtsrli1e8ya5l
yswe2dm4c5fdgtsrli1e8ya5l

<span class="nv">$ </span>docker service <span class="nb">ls
</span>ID                  NAME     MODE         REPLICAS   IMAGE               PORTS
b6lww17hrr4e        web      replicated   1/1        nginx:alpine
</code></pre></div></div>

<h3 id="specify-service-placement-preferences---placement-pref">Specify service placement preferences (--placement-pref)</h3>

<p>You can set up the service to divide tasks evenly over different categories of
nodes. One example of where this can be useful is to balance tasks over a set
of datacenters or availability zones. The example below illustrates this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
  <span class="nt">--replicas</span> 9 <span class="se">\</span>
  <span class="nt">--name</span> redis_2 <span class="se">\</span>
  <span class="nt">--placement-pref</span> <span class="nv">spread</span><span class="o">=</span>node.labels.datacenter <span class="se">\</span>
  redis:3.0.6
</code></pre></div></div>

<p>This uses <code class="highlighter-rouge">--placement-pref</code> with a <code class="highlighter-rouge">spread</code> strategy (currently the only
supported strategy) to spread tasks evenly over the values of the <code class="highlighter-rouge">datacenter</code>
node label. In this example, we assume that every node has a <code class="highlighter-rouge">datacenter</code> node
label attached to it. If there are three different values of this label among
nodes in the swarm, one third of the tasks will be placed on the nodes
associated with each value. This is true even if there are more nodes with one
value than another. For example, consider the following set of nodes:</p>

<ul>
  <li>Three nodes with <code class="highlighter-rouge">node.labels.datacenter=east</code></li>
  <li>Two nodes with <code class="highlighter-rouge">node.labels.datacenter=south</code></li>
  <li>One node with <code class="highlighter-rouge">node.labels.datacenter=west</code></li>
</ul>

<p>Since we are spreading over the values of the <code class="highlighter-rouge">datacenter</code> label and the
service has 9 replicas, 3 replicas will end up in each datacenter. There are
three nodes associated with the value <code class="highlighter-rouge">east</code>, so each one will get one of the
three replicas reserved for this value. There are two nodes with the value
<code class="highlighter-rouge">south</code>, and the three replicas for this value will be divided between them,
with one receiving two replicas and another receiving just one. Finally, <code class="highlighter-rouge">west</code>
has a single node that will get all three replicas reserved for <code class="highlighter-rouge">west</code>.</p>

<p>If the nodes in one category (for example, those with
<code class="highlighter-rouge">node.labels.datacenter=south</code>) can’t handle their fair share of tasks due to
constraints or resource limitations, the extra tasks will be assigned to other
nodes instead, if possible.</p>

<p>Both engine labels and node labels are supported by placement preferences. The
example above uses a node label, because the label is referenced with
<code class="highlighter-rouge">node.labels.datacenter</code>. To spread over the values of an engine label, use
<code class="highlighter-rouge">--placement-pref spread=engine.labels.&lt;labelname&gt;</code>.</p>

<p>It is possible to add multiple placement preferences to a service. This
establishes a hierarchy of preferences, so that tasks are first divided over
one category, and then further divided over additional categories. One example
of where this may be useful is dividing tasks fairly between datacenters, and
then splitting the tasks within each datacenter over a choice of racks. To add
multiple placement preferences, specify the <code class="highlighter-rouge">--placement-pref</code> flag multiple
times. The order is significant, and the placement preferences will be applied
in the order given when making scheduling decisions.</p>

<p>The following example sets up a service with multiple placement preferences.
Tasks are spread first over the various datacenters, and then over racks
(as indicated by the respective labels):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
  <span class="nt">--replicas</span> 9 <span class="se">\</span>
  <span class="nt">--name</span> redis_2 <span class="se">\</span>
  <span class="nt">--placement-pref</span> <span class="s1">'spread=node.labels.datacenter'</span> <span class="se">\</span>
  <span class="nt">--placement-pref</span> <span class="s1">'spread=node.labels.rack'</span> <span class="se">\</span>
  redis:3.0.6
</code></pre></div></div>

<p>When updating a service with <code class="highlighter-rouge">docker service update</code>, <code class="highlighter-rouge">--placement-pref-add</code>
appends a new placement preference after all existing placement preferences.
<code class="highlighter-rouge">--placement-pref-rm</code> removes an existing placement preference that matches the
argument.</p>

<h3 id="specify-memory-requirements-and-constraints-for-a-service---reserve-memory-and---limit-memory">Specify memory requirements and constraints for a service (--reserve-memory and --limit-memory)</h3>

<p>If your service needs a minimum amount of memory in order to run correctly,
you can use <code class="highlighter-rouge">--reserve-memory</code> to specify that the service should only be
scheduled on a node with this much memory available to reserve. If no node is
available that meets the criteria, the task is not scheduled, but remains in a
pending state.</p>

<p>The following example requires that 4GB of memory be available and reservable
on a given node before scheduling the service to run on that node.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="nt">--reserve-memory</span><span class="o">=</span>4GB <span class="nt">--name</span><span class="o">=</span>too-big nginx:alpine
</code></pre></div></div>

<p>The managers won’t schedule a set of containers on a single node whose combined
reservations exceed the memory available on that node.</p>

<p>After a task is scheduled and running, <code class="highlighter-rouge">--reserve-memory</code> does not enforce a
memory limit. Use <code class="highlighter-rouge">--limit-memory</code> to ensure that a task uses no more than a
given amount of memory on a node. This example limits the amount of memory used
by the task to 4GB. The task will be scheduled even if each of your nodes has
only 2GB of memory, because <code class="highlighter-rouge">--limit-memory</code> is an upper limit.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="nt">--limit-memory</span><span class="o">=</span>4GB <span class="nt">--name</span><span class="o">=</span>too-big nginx:alpine
</code></pre></div></div>

<p>Using <code class="highlighter-rouge">--reserve-memory</code> and <code class="highlighter-rouge">--limit-memory</code> does not guarantee that Docker
will not use more memory on your host than you want. For instance, you could
create many services, the sum of whose memory usage could exhaust the available
memory.</p>

<p>You can prevent this scenario from exhausting the available memory by taking
into account other (non-containerized) software running on the host as well. If
<code class="highlighter-rouge">--reserve-memory</code> is greater than or equal to <code class="highlighter-rouge">--limit-memory</code>, Docker won’t
schedule a service on a host that doesn’t have enough memory. <code class="highlighter-rouge">--limit-memory</code>
will limit the service’s memory to stay within that limit, so if every service
has a memory-reservation and limit set, Docker services will be less likely to
saturate the host. Other non-service containers or applications running directly
on the Docker host could still exhaust memory.</p>

<p>There is a downside to this approach. Reserving memory also means that you may
not make optimum use of the memory available on the node. Consider a service
that under normal circumstances uses 100MB of memory, but depending on load can
“peak” at 500MB. Reserving 500MB for that service (to guarantee can have 500MB
for those “peaks”) results in 400MB of memory being wasted most of the time.</p>

<p>In short, you can take a more conservative or more flexible approach:</p>

<ul>
  <li>
    <p><strong>Conservative</strong>: reserve 500MB, and limit to 500MB. Basically you’re now
treating the service containers as VMs, and you may be losing a big advantage
containers, which is greater density of services per host.</p>
  </li>
  <li>
    <p><strong>Flexible</strong>: limit to 500MB in the assumption that if the service requires
more than 500MB, it is malfunctioning. Reserve something between the 100MB
“normal” requirement and the 500MB “peak” requirement”. This assumes that when
this service is at “peak”, other services or non-container workloads probably
won’t be.</p>
  </li>
</ul>

<p>The approach you take depends heavily on the memory-usage patterns of your
workloads. You should test under normal and peak conditions before settling
on an approach.</p>

<p>On Linux, you can also limit a service’s overall memory footprint on a given
host at the level of the host operating system, using <code class="highlighter-rouge">cgroups</code> or other
relevant operating system tools.</p>

<h3 id="specify-maximum-replicas-per-node---replicas-max-per-node">Specify maximum replicas per node (--replicas-max-per-node)</h3>

<p>Use the <code class="highlighter-rouge">--replicas-max-per-node</code> flag to set the maximum number of replica tasks that can run on a node.
The following command creates a nginx service with 2 replica tasks but only one replica task per node.</p>

<p>One example where this can be useful is to balance tasks over a set of data centers together with <code class="highlighter-rouge">--placement-pref</code>
and let <code class="highlighter-rouge">--replicas-max-per-node</code> setting make sure that replicas are not migrated to another datacenter during
maintenance or datacenter failure.</p>

<p>The example below illustrates this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
  <span class="nt">--name</span> nginx <span class="se">\</span>
  <span class="nt">--replicas</span> 2 <span class="se">\</span>
  <span class="nt">--replicas-max-per-node</span> 1 <span class="se">\</span>
  <span class="nt">--placement-pref</span> <span class="s1">'spread=node.labels.datacenter'</span> <span class="se">\</span>
  nginx
</code></pre></div></div>

<h3 id="attach-a-service-to-an-existing-network---network">Attach a service to an existing network (--network)</h3>

<p>You can use overlay networks to connect one or more services within the swarm.</p>

<p>First, create an overlay network on a manager node the docker network create
command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker network create <span class="nt">--driver</span> overlay my-network

etjpu59cykrptrgw0z0hk5snf
</code></pre></div></div>

<p>After you create an overlay network in swarm mode, all manager nodes have
access to the network.</p>

<p>When you create a service and pass the <code class="highlighter-rouge">--network</code> flag to attach the service to
the overlay network:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
  <span class="nt">--replicas</span> 3 <span class="se">\</span>
  <span class="nt">--network</span> my-network <span class="se">\</span>
  <span class="nt">--name</span> my-web <span class="se">\</span>
  nginx

716thylsndqma81j6kkkb5aus
</code></pre></div></div>

<p>The swarm extends my-network to each node running the service.</p>

<p>Containers on the same network can access each other using
<a href="https://docs.docker.com/network/overlay/#container-discovery">service discovery</a>.</p>

<p>Long form syntax of <code class="highlighter-rouge">--network</code> allows to specify list of aliases and driver options:
<code class="highlighter-rouge">--network name=my-network,alias=web1,driver-opt=field1=value1</code></p>

<h3 id="publish-service-ports-externally-to-the-swarm--p---publish">Publish service ports externally to the swarm (-p, --publish)</h3>

<p>You can publish service ports to make them available externally to the swarm
using the <code class="highlighter-rouge">--publish</code> flag. The <code class="highlighter-rouge">--publish</code> flag can take two different styles
of arguments. The short version is positional, and allows you to specify the
published port and target port separated by a colon (<code class="highlighter-rouge">:</code>).</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="nt">--name</span> my_web <span class="nt">--replicas</span> 3 <span class="nt">--publish</span> 8080:80 nginx
</code></pre></div></div>

<p>There is also a long format, which is easier to read and allows you to specify
more options. The long format is preferred. You cannot specify the service’s
mode when using the short format. Here is an example of using the long format
for the same service as above:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="nt">--name</span> my_web <span class="nt">--replicas</span> 3 <span class="nt">--publish</span> <span class="nv">published</span><span class="o">=</span>8080,target<span class="o">=</span>80 nginx
</code></pre></div></div>

<p>The options you can specify are:</p>

<table>
<thead>
<tr>
  <th>Option</th>
  <th>Short syntax</th>
  <th>Long syntax</th>
  <th>Description</th>
</tr>
</thead>
<tr>
  <td>published and target port</td>
  <td><tt>--publish 8080:80</tt></td>
  <td><tt>--publish published=8080,target=80</tt></td>
  <td><p>
    The target port within the container and the port to map it to on the
    nodes, using the routing mesh (<tt>ingress</tt>) or host-level networking.
    More options are available, later in this table. The key-value syntax is
    preferred, because it is somewhat self-documenting.
  </p></td>
</tr>
<tr>
  <td>mode</td>
  <td>Not possible to set using short syntax.</td>
  <td><tt>--publish published=8080,target=80,mode=host</tt></td>
  <td><p>
    The mode to use for binding the port, either <tt>ingress</tt> or <tt>host</tt>.
    Defaults to <tt>ingress</tt> to use the routing mesh.
  </p></td>
</tr>
<tr>
  <td>protocol</td>
  <td><tt>--publish 8080:80/tcp</tt></td>
  <td><tt>--publish published=8080,target=80,protocol=tcp</tt></td>
  <td><p>
    The protocol to use, <tt>tcp</tt> , <tt>udp</tt>, or <tt>sctp</tt>. Defaults to
    <tt>tcp</tt>. To bind a port for both protocols, specify the <tt>-p</tt> or
    <tt>--publish</tt> flag twice.
  </p></td>
</tr>
</table>

<p>When you publish a service port using <code class="highlighter-rouge">ingress</code> mode, the swarm routing mesh
makes the service accessible at the published port on every node regardless if
there is a task for the service running on the node. If you use <code class="highlighter-rouge">host</code> mode,
the port is only bound on nodes where the service is running, and a given port
on a node can only be bound once. You can only set the publication mode using
the long syntax. For more information refer to
<a href="https://docs.docker.com/engine/swarm/ingress/">Use swarm mode routing mesh</a>.</p>

<h3 id="provide-credential-specs-for-managed-service-accounts-windows-only">Provide credential specs for managed service accounts (Windows only)</h3>

<p>This option is only used for services using Windows containers. The
<code class="highlighter-rouge">--credential-spec</code> must be in the format <code class="highlighter-rouge">file://&lt;filename&gt;</code> or
<code class="highlighter-rouge">registry://&lt;value-name&gt;</code>.</p>

<p>When using the <code class="highlighter-rouge">file://&lt;filename&gt;</code> format, the referenced file must be
present in the <code class="highlighter-rouge">CredentialSpecs</code> subdirectory in the docker data directory,
which defaults to <code class="highlighter-rouge">C:\ProgramData\Docker\</code> on Windows. For example,
specifying <code class="highlighter-rouge">file://spec.json</code> loads <code class="highlighter-rouge">C:\ProgramData\Docker\CredentialSpecs\spec.json</code>.</p>

<p>When using the <code class="highlighter-rouge">registry://&lt;value-name&gt;</code> format, the credential spec is
read from the Windows registry on the daemon’s host. The specified
registry value must be located in:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Virtualization\Containers\CredentialSpecs
</code></pre></div></div>

<h3 id="create-services-using-templates">Create services using templates</h3>

<p>You can use templates for some flags of <code class="highlighter-rouge">service create</code>, using the syntax
provided by the Go’s <a href="http://golang.org/pkg/text/template/">text/template</a> package.</p>

<p>The supported flags are the following :</p>

<ul>
  <li><code class="highlighter-rouge">--hostname</code></li>
  <li><code class="highlighter-rouge">--mount</code></li>
  <li><code class="highlighter-rouge">--env</code></li>
</ul>

<p>Valid placeholders for the Go template are listed below:</p>

<table>
  <tr>
    <th>Placeholder</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><tt>.Service.ID</tt></td>
    <td>Service ID</td>
  </tr>
  <tr>
    <td><tt>.Service.Name</tt></td>
    <td>Service name</td>
  </tr>
  <tr>
    <td><tt>.Service.Labels</tt></td>
    <td>Service labels</td>
  </tr>
  <tr>
    <td><tt>.Node.ID</tt></td>
    <td>Node ID</td>
  </tr>
  <tr>
    <td><tt>.Node.Hostname</tt></td>
    <td>Node Hostname</td>
  </tr>
  <tr>
    <td><tt>.Task.ID</tt></td>
    <td>Task ID</td>
  </tr>
  <tr>
    <td><tt>.Task.Name</tt></td>
    <td>Task name</td>
  </tr>
  <tr>
    <td><tt>.Task.Slot</tt></td>
    <td>Task slot</td>
  </tr>
</table>

<h4 id="template-example">Template example</h4>

<p>In this example, we are going to set the template of the created containers based on the
service’s name, the node’s ID and hostname where it sits.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
    <span class="nt">--name</span> hosttempl <span class="se">\</span>
    <span class="nt">--hostname</span><span class="o">=</span><span class="s2">"{{.Node.Hostname}}-{{.Node.ID}}-{{.Service.Name}}"</span><span class="se">\</span>
    busybox top

va8ew30grofhjoychbr6iot8c

<span class="nv">$ </span>docker service ps va8ew30grofhjoychbr6iot8c

ID            NAME         IMAGE                                                                                   NODE          DESIRED STATE  CURRENT STATE               ERROR  PORTS
wo41w8hg8qan  hosttempl.1  busybox:latest@sha256:29f5d56d12684887bdfa50dcd29fc31eea4aaf4ad3bec43daf19026a7ce69912  2e7a8a9c4da2  Running        Running about a minute ago

<span class="nv">$ </span>docker inspect <span class="nt">--format</span><span class="o">=</span><span class="s2">"{{.Config.Hostname}}"</span> 2e7a8a9c4da2-wo41w8hg8qanxwjwsg4kxpprj-hosttempl

x3ti0erg11rjpg64m75kej2mz-hosttempl
</code></pre></div></div>

<h3 id="specify-isolation-mode-windows">Specify isolation mode (Windows)</h3>

<p>By default, tasks scheduled on Windows nodes are run using the default isolation mode
configured for this particular node. To force a specific isolation mode, you can use
the <code class="highlighter-rouge">--isolation</code> flag:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="nt">--name</span> myservice <span class="nt">--isolation</span><span class="o">=</span>process microsoft/nanoserver
</code></pre></div></div>

<p>Supported isolation modes on Windows are:</p>
<ul>
  <li><code class="highlighter-rouge">default</code>: use default settings specified on the node running the task</li>
  <li><code class="highlighter-rouge">process</code>: use process isolation (Windows server only)</li>
  <li><code class="highlighter-rouge">hyperv</code>: use Hyper-V isolation</li>
</ul>

<h3 id="create-services-requesting-generic-resources">Create services requesting Generic Resources</h3>

<p>You can narrow the kind of nodes your task can land on through the using the
<code class="highlighter-rouge">--generic-resource</code> flag (if the nodes advertise these resources):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service create <span class="se">\</span>
    <span class="nt">--name</span> cuda <span class="se">\</span>
    <span class="nt">--generic-resource</span> <span class="s2">"NVIDIA-GPU=2"</span> <span class="se">\</span>
    <span class="nt">--generic-resource</span> <span class="s2">"SSD=1"</span> <span class="se">\</span>
    nvidia/cuda
</code></pre></div></div>

<h2 id="parent-command">上位コマンド</h2>

<table>
  <thead>
    <tr>
      <th>コマンド</th>
      <th>説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="/docs.docker.jp.onthefly/engine/reference/commandline/service/">docker service</a></td>
      <td>Manage services</td>
    </tr>
  </tbody>
</table>

<h2 id="related-commands">関連コマンド</h2>

<table>
<thead>
  <tr>
    <td>コマンド</td>
    <td>説明</td>
  </tr>
</thead>
<tbody>

  
  <tr>
    <td><a href="/docs.docker.jp.onthefly/engine/reference/commandline/service_create/">docker service create</a></td>
    <td>Create a new service</td>
  </tr>

  
  <tr>
    <td><a href="/docs.docker.jp.onthefly/engine/reference/commandline/service_inspect/">docker service inspect</a></td>
    <td>Display detailed information on one or more services</td>
  </tr>

  
  <tr>
    <td><a href="/docs.docker.jp.onthefly/engine/reference/commandline/service_logs/">docker service logs</a></td>
    <td>Fetch the logs of a service or task</td>
  </tr>

  
  <tr>
    <td><a href="/docs.docker.jp.onthefly/engine/reference/commandline/service_ls/">docker service ls</a></td>
    <td>List services</td>
  </tr>

  
  <tr>
    <td><a href="/docs.docker.jp.onthefly/engine/reference/commandline/service_ps/">docker service ps</a></td>
    <td>List the tasks of one or more services</td>
  </tr>

  
  <tr>
    <td><a href="/docs.docker.jp.onthefly/engine/reference/commandline/service_rm/">docker service rm</a></td>
    <td>Remove one or more services</td>
  </tr>

  
  <tr>
    <td><a href="/docs.docker.jp.onthefly/engine/reference/commandline/service_rollback/">docker service rollback</a></td>
    <td>Revert changes to a service’s configuration</td>
  </tr>

  
  <tr>
    <td><a href="/docs.docker.jp.onthefly/engine/reference/commandline/service_scale/">docker service scale</a></td>
    <td>Scale one or multiple replicated services</td>
  </tr>

  
  <tr>
    <td><a href="/docs.docker.jp.onthefly/engine/reference/commandline/service_update/">docker service update</a></td>
    <td>Update a service</td>
  </tr>

</tbody>
</table>


                            <!-- tags -->
                            
                            
                            
                            <div id="ratings-div"
                                style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
                                <div id="pd_rating_holder_8453675"></div>
                                <script type="text/javascript">
                                    PDRTJS_settings_8453675 = {
                                        "id": "8453675",
                                        "unique_id": "engine/reference/commandline/service_create.md",
                                        "title": "docker service create",
                                        "permalink": "https://github.com/docker/docker.github.io/blob/master/engine/reference/commandline/service_create.md"
                                    };
                                    (function (d, c, j) {
                                        if (!document.getElementById(j)) {
                                            var pd = d.createElement(c),
                                                s;
                                            pd.id = j;
                                            pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
                                            s = document.getElementsByTagName(c)[0];
                                            s.parentNode.insertBefore(pd, s);
                                        }
                                    }(document, 'script', 'pd-rating-js'));
                                </script>
                            </div>
                            
                        </section>
                    </main>
                    <nav class="col-nav">
                        <div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
                            <div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

                        </div>
                    </nav>
                    <div class="col-toc">
                        <div class="sidebar hidden-xs hidden-sm">
                            <div class="toc-nav">
                                <div class="feedback-links">
                                    <ul>
                                        
                                        <li style="visibility: hidden"><a href="https://github.com/matsuand/docs.docker.jp/edit/v19.03.local/engine/reference/commandline/service_create.md"><i
                                                    class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
                                        <li><a href="https://github.com/matsuand/docs.docker.jp/issues/new?body=ファイル: [engine/reference/commandline/service_create.md](https://matsuand.github.io/docs.docker.jp.onthefly/engine/reference/commandline/service_create/)"
                                                class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
                                        <!-- toggle mode -->
                                        <li>
                                            <div class="toggle-mode">
                                                <div class="icon">
                                                    <i class="fa fa-sun-o" aria-hidden="true"></i>
                                                </div>
                                                <div class="toggle-switch">
                                                    <label class="switch">
                                                        <input type="checkbox" id="switch-style">
                                                        <div class="slider round"></div>
                                                    </label>
                                                </div>
                                                <div class="icon">
                                                    <i class="fa fa-moon-o" aria-hidden="true"></i>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                
                                
                                
                                
                                <div id="side-toc-title">本ページ内:</div>
                                
<ul id="my_toc" class="inline_toc">
  <li><a href="#description" class="nomunge">説明</a></li>
  <li><a href="#usage" class="nomunge">利用方法</a></li>
  <li><a href="#extended-description" class="nomunge">Extended description</a></li>
  <li><a href="#options" class="nomunge">オプション</a></li>
  <li><a href="#examples" class="nomunge">Examples</a>
    <ul>
      <li><a href="#create-a-service" class="nomunge">Create a service</a></li>
      <li><a href="#create-a-service-with-5-replica-tasks---replicas" class="nomunge">Create a service with 5 replica tasks (--replicas)</a></li>
      <li><a href="#create-a-service-with-secrets" class="nomunge">Create a service with secrets</a></li>
      <li><a href="#create-a-service-with-configs" class="nomunge">Create a service with configs</a></li>
      <li><a href="#create-a-service-with-a-rolling-update-policy" class="nomunge">Create a service with a rolling update policy</a></li>
      <li><a href="#set-environment-variables--e---env" class="nomunge">Set environment variables (-e, --env)</a></li>
      <li><a href="#create-a-service-with-specific-hostname---hostname" class="nomunge">Create a service with specific hostname (--hostname)</a></li>
      <li><a href="#set-metadata-on-a-service--l---label" class="nomunge">Set metadata on a service (-l, --label)</a></li>
      <li><a href="#add-bind-mounts-volumes-or-memory-filesystems" class="nomunge">Add bind mounts, volumes or memory filesystems</a></li>
      <li><a href="#set-service-mode---mode" class="nomunge">Set service mode (--mode)</a></li>
      <li><a href="#specify-service-constraints---constraint" class="nomunge">Specify service constraints (--constraint)</a></li>
      <li><a href="#specify-service-placement-preferences---placement-pref" class="nomunge">Specify service placement preferences (--placement-pref)</a></li>
      <li><a href="#specify-memory-requirements-and-constraints-for-a-service---reserve-memory-and---limit-memory" class="nomunge">Specify memory requirements and constraints for a service (--reserve-memory and --limit-memory)</a></li>
      <li><a href="#specify-maximum-replicas-per-node---replicas-max-per-node" class="nomunge">Specify maximum replicas per node (--replicas-max-per-node)</a></li>
      <li><a href="#attach-a-service-to-an-existing-network---network" class="nomunge">Attach a service to an existing network (--network)</a></li>
      <li><a href="#publish-service-ports-externally-to-the-swarm--p---publish" class="nomunge">Publish service ports externally to the swarm (-p, --publish)</a></li>
      <li><a href="#provide-credential-specs-for-managed-service-accounts-windows-only" class="nomunge">Provide credential specs for managed service accounts (Windows only)</a></li>
      <li><a href="#create-services-using-templates" class="nomunge">Create services using templates</a></li>
      <li><a href="#specify-isolation-mode-windows" class="nomunge">Specify isolation mode (Windows)</a></li>
      <li><a href="#create-services-requesting-generic-resources" class="nomunge">Create services requesting Generic Resources</a></li>
    </ul>
  </li>
  <li><a href="#parent-command" class="nomunge">上位コマンド</a></li>
  <li><a href="#related-commands" class="nomunge">関連コマンド</a></li>
</ul>


                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    
    <footer class="footer">
          
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/why-docker">Why Docker</a></b></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/overview">Products</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub">Docker Hub</a></li>
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Features</a></b></li>
                        <li><a href="https://www.docker.com/products/container-runtime">Container Runtime</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools">Developer Tools</a></li>
                        <li><a href="https://www.docker.com/products/kubernetes">Kubernetes</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Developers</a></b></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/play-with-docker">Play with Docker</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/open-source">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank">Company</a></b></li>
                        <li><a href="https://www.docker.com/company">About Us</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank">Blog</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners">Partners</a></li>
                        <li><a href="https://www.docker.com/company/newsroom">Newsroom</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2013-2020 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

    </footer>
    <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/github.css">
    
    <script defer src="/docs.docker.jp.onthefly/js/anchorlinks.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/menu.js"></script>
    <script src="/docs.docker.jp.onthefly/js/jquery.js"></script>
    <script src="/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
    <!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
    <script>
        // Default to assuming this is an archive and hiding some stuff
        // See js/archive.js and js/docs.js for logic relating to this
        var isArchive = true;
        var dockerVersion = 'v19.03';
        // In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
        var jekyllEnv = 'development';
        // If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
        if (jekyllEnv === 'development') {
            jekyllEnv = '';
        }
        var pageURL = jekyllEnv + '/engine/reference/commandline/service_create/';
    </script>
    <script src="/docs.docker.jp.onthefly/js/archive.js"></script>
    <script src="/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/metadata.js"></script>
    <script src="/docs.docker.jp.onthefly/js/glossary.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/docs.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/toc.js"></script>
    <script>
        jQuery(document).ready(function () { hookupTOCEvents(); });
    </script>
</body>


</html>
